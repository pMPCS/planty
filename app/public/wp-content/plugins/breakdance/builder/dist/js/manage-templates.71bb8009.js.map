{"version":3,"file":"js/manage-templates.71bb8009.js","mappings":"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","sources":["webpack://builder/./src/lib/ai/ai.ts","webpack://builder/./src/lib/ai/api.ts","webpack://builder/./src/lib/ai/prompts.ts","webpack://builder/./src/lib/ai/types.ts","webpack://builder/./src/lib/canvas/flatten-properties.ts","webpack://builder/./src/types/copy-paste.ts","webpack://builder/./src/lib/copy-paste/copy-paste.ts","webpack://builder/./src/lib/copy-paste/utils.ts","webpack://builder/./src/lib/global-blocks/global-blocks.ts","webpack://builder/./src/lib/global-settings/global-settings.ts","webpack://builder/./src/lib/panels/accordions.ts","webpack://builder/./src/lib/selectors/selectors.ts","webpack://builder/./src/lib/wordpress/load.ts","webpack://builder/./src/subapps/manage-templates/ManageBreakdancePostTypes.vue","webpack://builder/./src/subapps/manage-templates/ManageTemplates.vue","webpack://builder/./src/subapps/manage-templates/TemplateRow.vue","webpack://builder/./src/components/Reusable/CustomInputs/ConditionInput/ConditionPreviewTooltip.vue","webpack://builder/./src/components/Reusable/CustomInputs/ConditionInput/ConditionPreviewTooltip.vue?3595","webpack://builder/./src/components/Reusable/CustomInputs/ConditionInput/ConditionPreviewTooltip.vue?2add","webpack://builder/./src/components/Reusable/CustomInputs/ConditionInput/ConditionPreviewTooltip.vue?d628","webpack://builder/./src/subapps/manage-templates/lib/quick-add-templates.ts","webpack://builder/./src/subapps/manage-templates/TemplateRow.vue?ba39","webpack://builder/./src/subapps/manage-templates/TemplateRow.vue?fcb1","webpack://builder/./src/subapps/manage-templates/TemplateRow.vue?e9a3","webpack://builder/./src/subapps/manage-templates/AddTemplateDropdown.vue","webpack://builder/./src/subapps/manage-templates/AddTemplateDropdown.vue?b0c1","webpack://builder/./src/subapps/manage-templates/AddTemplateDropdown.vue?137a","webpack://builder/./src/subapps/manage-templates/AddTemplateDropdown.vue?fa68","webpack://builder/./src/subapps/manage-templates/EmptyState.vue","webpack://builder/./src/subapps/manage-templates/EmptyState.vue?b9e8","webpack://builder/./src/subapps/manage-templates/EmptyState.vue?d29b","webpack://builder/./src/subapps/manage-templates/EmptyState.vue?60a9","webpack://builder/./src/subapps/manage-templates/ManageTemplates.vue?f496","webpack://builder/./src/subapps/manage-templates/ManageTemplates.vue?1153","webpack://builder/./src/subapps/manage-templates/ManageTemplates.vue?c1a6","webpack://builder/./src/subapps/manage-templates/ManageGlobalBlocks.vue","webpack://builder/./src/subapps/manage-templates/EditGlobalBlockModal.vue","webpack://builder/./src/subapps/manage-templates/EditGlobalBlockModal.vue?66ea","webpack://builder/./src/subapps/manage-templates/EditGlobalBlockModal.vue?45de","webpack://builder/./src/subapps/manage-templates/EditGlobalBlockModal.vue?0bfd","webpack://builder/./src/subapps/manage-templates/BlockRow.vue","webpack://builder/./src/subapps/manage-templates/BlockRow.vue?ca87","webpack://builder/./src/subapps/manage-templates/BlockRow.vue?3710","webpack://builder/./src/subapps/manage-templates/BlockRow.vue?5bc4","webpack://builder/./src/subapps/manage-templates/ManageGlobalBlocks.vue?9c69","webpack://builder/./src/subapps/manage-templates/ManageGlobalBlocks.vue?983b","webpack://builder/./src/subapps/manage-templates/ManageGlobalBlocks.vue?e595","webpack://builder/./src/subapps/manage-templates/ManageBreakdancePostTypes.vue?e995","webpack://builder/./src/subapps/manage-templates/ManageBreakdancePostTypes.vue?8098","webpack://builder/./src/subapps/manage-templates/ManageBreakdancePostTypes.vue?62ea","webpack://builder/./src/subapps/manage-templates/entry.ts","webpack://builder/./src/subapps/manage-templates/lib/api.ts","webpack://builder/./src/subapps/manage-templates/lib/utils.ts","webpack://builder/./src/subapps/manage-templates/types.ts","webpack://builder/./src/types/custom-fonts.ts","webpack://builder/./src/types/design-library.ts","webpack://builder/./src/types/elements.ts","webpack://builder/./src/types/global-blocks.ts","webpack://builder/./src/types/load.ts","webpack://builder/./src/types/selectors.ts","webpack://builder/./src/types/templates.ts","webpack://builder/./src/util/fp-json-parse-typesafe.ts","webpack://builder/webpack/bootstrap","webpack://builder/webpack/runtime/chunk loaded","webpack://builder/webpack/runtime/compat get default export","webpack://builder/webpack/runtime/define property getters","webpack://builder/webpack/runtime/global","webpack://builder/webpack/runtime/hasOwnProperty shorthand","webpack://builder/webpack/runtime/make namespace object","webpack://builder/webpack/runtime/node module decorator","webpack://builder/webpack/runtime/runtimeId","webpack://builder/webpack/runtime/jsonp chunk loading","webpack://builder/webpack/startup"],"sourcesContent":["import lodash from \"lodash\";\nimport { Tree, TreeNode } from \"@/types/tree\";\nimport { Control } from \"@/types/controls\";\nimport { configStore, documentStore } from \"@/store/store\";\nimport {\n  FieldToComplete,\n  CompletedField,\n  PromptInfo,\n  UnsplashImage,\n  FieldToFill,\n  OpenAIErrorV\n} from \"@/lib/ai/types\";\nimport { numberToOrdinal } from \"@/lib/ai/prompts\";\n\nimport fpJsonParse from \"@/util/fp-json-parse\";\nimport { pipe } from \"fp-ts/lib/function\";\nimport { fold } from \"fp-ts/lib/Either\";\nimport { findNode, getNodeIndex, getOutermostAncestor } from \"../tree/tree\";\nimport { SECTION_SLUG } from \"@/lib/elements/constants\";\nimport defensiveCopy from \"@/util/defensive-copy\";\nimport fpJsonParseTypesafe from \"@/util/fp-json-parse-typesafe\";\nimport NotificationLogger from \"@/lib/notifications/notifications\";\n\nconst emptyCompletion = {\n  elements: [],\n  unsplash_keywords: []\n};\n\nexport function processCompletion(\n  maybeJsonCompletion: string | undefined,\n  fieldsToComplete: FieldToComplete[]\n): {\n  elements: CompletedField[];\n  unsplash_keywords: string[];\n} {\n  if (!maybeJsonCompletion) {\n    return emptyCompletion;\n  }\n\n  const output = pipe(\n    fpJsonParse(maybeJsonCompletion),\n    fold(\n      errors => {\n        console.log(\"Error parsing JSON from AI:\", errors[0].msg);\n        console.log(maybeJsonCompletion);\n        console.log(\"\");\n        return null;\n      },\n      completion => completion\n    )\n  ) as {\n    elements: FieldToFill[];\n    unsplash_keywords: string[];\n  };\n\n  if (!output) {\n    return emptyCompletion;\n  }\n\n  if (!Array.isArray(output?.elements)) {\n    return emptyCompletion;\n  }\n\n  return {\n    ...output,\n    elements: output.elements\n      .filter(e => {\n        // Remove elements that don't have an index and content set.\n        // This usually happens when the AI hasn't finished generating the completion.\n        return e.index !== undefined && e.content !== undefined;\n      })\n      .map(g => ({\n        nodeId: fieldsToComplete[g.index].nodeId,\n        controlPath: fieldsToComplete[g.index].controlPath,\n        value: g.content\n      }))\n  };\n}\n\nlet lastFields: CompletedField[] = [];\n\nfunction isSameField(a: CompletedField, b: CompletedField) {\n  return (\n    a.nodeId === b.nodeId &&\n    a.controlPath === b.controlPath &&\n    a.value === b.value\n  );\n}\n\nexport function updateDocument(fields: CompletedField[]) {\n  const newFields = fields.filter(\n    f => !lastFields.some(lf => isSameField(lf, f))\n  );\n\n  lastFields = fields;\n\n  newFields.forEach(v => {\n    documentStore.throttledPropertyChanged({\n      elementId: v.nodeId,\n      path: v.controlPath,\n      value: v.value,\n      meta: {\n        snapshotLabel: \"Update from Generative AI\"\n      }\n    });\n  });\n}\n\nexport function updateImages(\n  imagesFields: FieldToComplete[],\n  unsplashResults: UnsplashImage[],\n  fillEmptyOnly: boolean\n) {\n  imagesFields\n    .filter(i => {\n      if (fillEmptyOnly) {\n        const maybeNode = findNode(documentStore.document.tree, i.nodeId);\n        if (!maybeNode) return false;\n        const currentValue = lodash.get(\n          maybeNode.data.properties,\n          i.controlPath\n        );\n\n        return (\n          currentValue === null ||\n          currentValue === undefined ||\n          currentValue === \"\"\n        );\n      }\n\n      return true;\n    })\n    .forEach((image, index) => {\n      const img = unsplashResults[index];\n\n      documentStore.unthrottledPropertyChanged({\n        elementId: image.nodeId,\n        path: image.controlPath,\n        value: {\n          id: -1,\n          type: \"external_image\",\n          url: img.urls.regular,\n          alt: img.alt_description || \"\",\n          caption: img.description || \"\"\n        },\n        meta: {\n          snapshotLabel: \"Update image from Generative AI\"\n        }\n      });\n    });\n}\n\n// TODO: Refactor to a functional style\n\nexport function getFieldsToComplete(\n  node: TreeNode,\n  acc: FieldToComplete[] = []\n): FieldToComplete[] {\n  const element = configStore.element(node.data.type);\n\n  if (element.settings && element.settings.disableAI) return acc;\n\n  let acc_: FieldToComplete[] = [\n    ...acc,\n    ...getFieldsToCompleteFromControls(\n      element.controls.contentSections,\n      \"content\",\n      node\n    )\n  ];\n\n  node.children.forEach(n => {\n    acc_ = getFieldsToComplete(n, acc_);\n  });\n\n  return acc_;\n}\n\nexport function getImagesToComplete(\n  node: TreeNode,\n  acc: FieldToComplete[] = []\n): FieldToComplete[] {\n  let acc_: FieldToComplete[] = [\n    ...acc,\n    ...getImagesToCompleteFromControls(\n      configStore.element(node.data.type).controls.contentSections,\n      \"content\",\n      node\n    )\n  ];\n\n  node.children.forEach(n => {\n    acc_ = getImagesToComplete(n, acc_);\n  });\n\n  return acc_;\n}\n\nfunction getImagesToCompleteFromControls(\n  controls: Control[],\n  path: string,\n  node: TreeNode,\n  acc: FieldToComplete[] = []\n) {\n  const element = configStore.element(node.data.type);\n  const _acc = acc;\n\n  controls.forEach(control => {\n    const controlPath = `${path}.${control.slug}`;\n\n    if (control.options.type === \"wpmedia\") {\n      _acc.push({\n        nodeId: node.id,\n        nodeName: element.name,\n        controlPath: controlPath,\n        field: {\n          description: getFieldDescription(\n            control,\n            controlPath,\n            node.data.type\n          ),\n          label: control.label,\n          value: lodash.get(node.data.properties, controlPath),\n          type: control.options.type,\n          locked: isFieldLocked(node, controlPath)\n        }\n      });\n    }\n\n    getImagesToCompleteFromControls(control.children, controlPath, node, _acc);\n  });\n\n  return _acc;\n}\n\nfunction getFieldsToCompleteFromControls(\n  controls: Control[],\n  path: string,\n  node: TreeNode,\n  acc: FieldToComplete[] = []\n) {\n  const element = configStore.element(node.data.type);\n  const _acc = acc;\n\n  controls.forEach(control => {\n    const controlPath = `${path}.${control.slug}`;\n\n    if (isControlSupported(control) && !isValueEmpty(control, path, node)) {\n      _acc.push({\n        nodeId: node.id,\n        controlPath: controlPath,\n        nodeName: element.name,\n        field: {\n          description: getFieldDescription(\n            control,\n            controlPath,\n            node.data.type\n          ),\n          label: control.label,\n          value: lodash.get(node.data.properties, controlPath),\n          type: control.options.type,\n          locked: isFieldLocked(node, controlPath)\n        }\n      });\n    }\n\n    // Ignore controls inside repeaters\n    if (control.options.type === \"repeater\") return;\n\n    getFieldsToCompleteFromControls(control.children, controlPath, node, _acc);\n  });\n\n  return _acc;\n}\n\nfunction isValueEmpty(control: Control, path: string, node: TreeNode) {\n  const controlPath = `${path}.${control.slug}`;\n  const value = lodash.get(node.data.properties, controlPath, \"\");\n  return value === \"\" || value === null || value === undefined;\n}\n\nfunction isControlSupported(control: Control) {\n  return [\"text\", \"richtext\", \"repeater\"].includes(control.options.type);\n}\n\nfunction getFieldDescription(\n  control: Control,\n  controlPath: string,\n  elementType: string\n) {\n  const elementName = configStore.element(elementType).name;\n\n  if (control.options.type === \"repeater\") {\n    const childControls = control.children\n      .filter(isControlSupported)\n      .map(childControl => childControl.slug);\n\n    const keys = childControls.join(\", \");\n    return `${elementName} - An array of objects with the following keys: ${keys}.`;\n  }\n\n  if (controlPath.endsWith(\"button.text\")) {\n    return `${elementName} - Button`;\n  }\n\n  if (elementName === control.label) {\n    return elementName;\n  }\n\n  return `${elementName} - ${control.label}`;\n}\n\nexport function generateElementDescription(\n  tree: Tree,\n  node: TreeNode,\n  postTitle: string,\n  postType: string\n) {\n  const elementName = configStore.element(node.data.type).name;\n  const nodeIndex = getNodeIndex(tree, node.id) as number;\n  const parent = getOutermostAncestor(tree, node.id);\n  const parentName = parent ? configStore.element(parent.data.type).name : \"\";\n  const parts = [];\n\n  if (parent) {\n    const parentIndex = getNodeIndex(tree, parent.id) as number;\n    const ordinal = numberToOrdinal(parentIndex + 1);\n\n    parts.push(elementName);\n    parts.push(\"on\");\n    parts.push(ordinal);\n    parts.push(parentName);\n  } else if (node.data.type === SECTION_SLUG) {\n    const ordinal = numberToOrdinal(nodeIndex + 1);\n    parts.push(nodeIndex === 0 ? \"Hero\" : ordinal);\n    parts.push(\"section\");\n  }\n\n  parts.push(\"on\");\n  parts.push(`\"${postTitle}\"`);\n\n  parts.push(postType.replace(\"breakdance_\", \"\"));\n\n  return parts.join(\" \");\n}\n\nexport function getElementFriendlyName(node: TreeNode) {\n  const friendlyName = node.data?.properties?.meta?.friendlyName;\n  if (friendlyName) return friendlyName;\n  const elementName = configStore.element(node.data.type).name;\n  return `${elementName} #${node.id}`;\n}\n\nexport function getElementPrompt(\n  node: TreeNode\n): Partial<PromptInfo> | undefined {\n  return node.data?.properties?.meta?.promptInfo;\n}\n\nexport function getElementDescription(node: TreeNode) {\n  const doc = documentStore.document.documentMeta;\n  const metadata = getElementPrompt(node);\n\n  // Get description saved in element metadata\n  if (metadata?.sectionDescription) {\n    return metadata.sectionDescription;\n  }\n\n  // Otherwise, generate a default description\n  return generateElementDescription(\n    documentStore.document.tree,\n    node,\n    doc.titleLabel,\n    doc.postType\n  );\n}\n\nexport function getElementQualifier(node: TreeNode) {\n  const metadata = getElementPrompt(node);\n  return metadata?.qualifiers || \"\";\n}\n\nexport function getElementTemperature(node: TreeNode) {\n  const temperature = getElementPrompt(node)?.temperature;\n  return temperature !== undefined ? temperature : 1;\n}\n\nexport function saveToElementMetadata(node: TreeNode, promptInfo: PromptInfo) {\n  const elementName = configStore.element(node.data.type).name;\n\n  documentStore.unthrottledPropertyChanged({\n    elementId: node.id,\n    path: \"meta.promptInfo\",\n    meta: {\n      snapshotLabel: `Updated prompt info for element \"${elementName}\"`\n    },\n    value: promptInfo\n  });\n}\n\nexport function lockFieldFromAI(node: TreeNode, fieldPath: string) {\n  const elementName = configStore.element(node.data.type).name;\n\n  const lockedFields = getElementPrompt(node)?.lockedFields || [];\n  const newLockedFields = defensiveCopy(lockedFields);\n\n  if (!newLockedFields.includes(fieldPath)) {\n    newLockedFields.push(fieldPath);\n  }\n\n  documentStore.unthrottledPropertyChanged({\n    elementId: node.id,\n    path: `meta.promptInfo.lockedFields`,\n    meta: {\n      snapshotLabel: `Locked field \"${fieldPath}\" for element \"${elementName}\"`\n    },\n    value: newLockedFields\n  });\n}\n\nexport function unlockFieldFromAI(node: TreeNode, fieldPath: string) {\n  const elementName = configStore.element(node.data.type).name;\n\n  const lockedFields = getElementPrompt(node)?.lockedFields || [];\n  const newLockedFields = defensiveCopy(lockedFields);\n\n  const index = newLockedFields.indexOf(fieldPath);\n  if (index > -1) {\n    newLockedFields.splice(index, 1);\n  }\n\n  documentStore.unthrottledPropertyChanged({\n    elementId: node.id,\n    path: `meta.promptInfo.lockedFields`,\n    meta: {\n      snapshotLabel: `Unlocked field \"${fieldPath}\" for element \"${elementName}\"`\n    },\n    value: newLockedFields\n  });\n}\n\nexport function toggleFieldLock(node: TreeNode, fieldPath: string) {\n  if (isFieldLocked(node, fieldPath)) {\n    unlockFieldFromAI(node, fieldPath);\n  } else {\n    lockFieldFromAI(node, fieldPath);\n  }\n}\n\nexport function isFieldLocked(node: TreeNode, fieldPath: string) {\n  const lockedFields = getElementPrompt(node)?.lockedFields || [];\n  return lockedFields.includes(fieldPath);\n}\n\nexport function getLockedFieldsPath(node: TreeNode) {\n  return getElementPrompt(node)?.lockedFields || [];\n}\n\nexport function handleAiError(error: string) {\n  const defaultErrorMessage =\n    \"Failed to get a response from OpenAI API, please try again.\";\n\n  const cleanErrorString = error\n    .slice(1, -1) // Remove first and last character (\")\n    .replace(/\\\\n/g, \"\") // Remove new lines\n    .replace(/\\\\\"/g, '\"') // Replace \\\" with \"\n    .trim();\n\n  const response = pipe(\n    fpJsonParseTypesafe(cleanErrorString, OpenAIErrorV),\n    fold(\n      () => null,\n      res => res\n    )\n  );\n\n  const message = response?.error?.message || defaultErrorMessage;\n\n  console.log(cleanErrorString);\n  NotificationLogger.log.errorMessage(message);\n}\n","import { Either, fold } from \"fp-ts/lib/Either\";\nimport * as t from \"io-ts\";\nimport { makeWordPressAjaxRequest } from \"@/lib/wordpress/ajax\";\nimport { _Error } from \"@/lib/wordpress/data\";\nimport {\n  AISettingsV,\n  ChatMessage,\n  CompletionFormat,\n  UnsplashImage,\n  UnsplashImageV\n} from \"./types\";\nimport { fpJsonStringify } from \"@/util/fp-json-stringify\";\nimport fpJsonParse from \"@/util/fp-json-parse\";\nimport { pipe } from \"fp-ts/lib/function\";\nimport { globalStore } from \"@/store/store\";\nimport { breakdanceUndo } from \"../undo/undo\";\nimport jsonAutocomplete from \"json-autocomplete\";\n\nexport async function requestCompletion(\n  messages: ChatMessage[],\n  format: CompletionFormat = \"json\"\n): Promise<Either<_Error[], string>> {\n  return makeWordPressAjaxRequest({\n    action: \"breakdance_ai_request_completion\",\n    friendlyName: \"AI Assistant\",\n    dataToPost: {\n      messages: fpJsonStringify(messages),\n      format: format\n    },\n    decoder: t.string,\n    resultKey: \"data\"\n  });\n}\n\nexport async function persistMessages(\n  messages: ChatMessage[],\n  format: CompletionFormat = \"json\",\n  temperature: number\n) {\n  await makeWordPressAjaxRequest({\n    action: \"breakdance_ai_persist_messages\",\n    friendlyName: \"AI Assistant - Persist Messages\",\n    dataToPost: {\n      messages: fpJsonStringify(messages),\n      format,\n      temperature\n    },\n    decoder: t.type({ status: t.literal(\"ok\") })\n  });\n}\n\nexport function getEventSource() {\n  const url =\n    window.Breakdance.restUrl +\n    \"/ai/stream-completion?_wpnonce=\" +\n    window.Breakdance.restNonce;\n  return new EventSource(url);\n}\n\nexport function getTextFromChunk(chunk: string) {\n  const json = pipe(\n    chunk,\n    fpJsonParse,\n    fold(\n      () => {},\n      x => x as any\n    )\n  );\n\n  const text = json?.choices[0].delta.content;\n\n  if (text !== null && text !== undefined) {\n    return text;\n  }\n\n  return \"\";\n}\n\n// Clean the JSON string and mutate the original string.\nexport function cleanJson(json: string) {\n  // Remove code block markdown, this is only needed if JSON Mode is enabled.\n  json = json.replace(\"```json\", \"\");\n  json = json.replace(/^json/g, \"\");\n  json = json.replace(\"```\", \"\");\n  return json;\n}\n\n// Clean the JSON string but don't mutate the original string.\nexport function cleanJsonBeforeParse(json: string) {\n  // const lastDoubleQuote = json.trim().lastIndexOf('\"');\n  // const lastSimpleQuote = json.trim().lastIndexOf(\"'\");\n  // if (lastSimpleQuote > lastDoubleQuote) {\n  //   // When the JSON string ends with a text containing a simple quote, without an ending double-quote jsonrepeair fail...\n  //   json = `${json}\"`;\n  // }\n  //\n  // const lastComma = json.trim().lastIndexOf(\",\");\n  // if (lastComma > lastDoubleQuote + 1) {\n  //   // The +1 is to avoid to catch a property separator comma `\", \"`\n  //   // When the JSON string ends with a text containing a comma, without an ending double-quote jsonrepeair explodes.\n  //   json = `${json}\"`;\n  // }\n  json = json.replace('\"index\" 0', '\"index\": 0'); // Common error.\n  json = json.replace('index\" 0', '\"index\": 0'); // Common error.\n  json = json.replace('\"index 0', '\"index\": 0'); // Common error.\n\n  return jsonAutocomplete(json);\n}\n\nexport async function getSuggestedPrompts(prompt: string) {\n  return makeWordPressAjaxRequest({\n    action: \"breakdance_ai_get_suggested_prompts\",\n    friendlyName: \"AI Assistant\",\n    dataToPost: {\n      prompt\n    },\n    decoder: t.type({\n      prompts: t.array(t.string)\n    }),\n    resultKey: \"data\"\n  });\n}\n\nexport async function talkToUnsplash(\n  keywords: string[],\n  limit: number,\n  orientation?: \"landscape\" | \"portrait\" | \"squarish\" | null\n): Promise<UnsplashImage[]> {\n  const request = await makeWordPressAjaxRequest({\n    action: \"breakdance_ai_talk_to_unsplash\",\n    friendlyName: \"Unsplash Assistant\",\n    dataToPost: {\n      prompt: keywords.join(\", \"),\n      limit,\n      orientation\n    },\n    decoder: t.array(UnsplashImageV),\n    resultKey: \"data\"\n  });\n\n  return pipe(\n    request,\n    fold(\n      () => [],\n      response => response\n    )\n  );\n}\n\nexport async function fetchAiSettings() {\n  const settings = await makeWordPressAjaxRequest({\n    action: \"breakdance_ai_get_settings\",\n    decoder: AISettingsV,\n    resultKey: \"data\",\n    suppressErrorLogging: true\n  });\n\n  return pipe(\n    settings,\n    fold(\n      () => false,\n      loadedData => {\n        breakdanceUndo.ignore(() => {\n          globalStore.setAiSettings(loadedData);\n          globalStore.markCurrentAiSettingsAsUntouched();\n        });\n        return true;\n      }\n    )\n  );\n}\n\nexport async function saveAiSettings() {\n  const settings = globalStore.aiSettings;\n\n  const request = await makeWordPressAjaxRequest({\n    action: \"breakdance_ai_save_settings\",\n    dataToPost: {\n      settings: fpJsonStringify(settings.prompt)\n    },\n    decoder: AISettingsV,\n    resultKey: \"data\"\n  });\n\n  return pipe(\n    request,\n    fold(\n      () => false,\n      loadedData => {\n        breakdanceUndo.ignore(() => {\n          globalStore.setAiSettings(loadedData);\n          globalStore.markCurrentAiSettingsAsUntouched();\n        });\n        return true;\n      }\n    )\n  );\n}\n","import { fold } from \"fp-ts/lib/Either\";\nimport { pipe } from \"fp-ts/lib/function\";\n\nimport {\n  ChatMessage,\n  FieldToComplete,\n  FieldToFill,\n  PromptInfo,\n  PromptSettings\n} from \"./types\";\n\nimport { fpJsonStringify } from \"@/util/fp-json-stringify\";\n\nexport function formatFieldsForOpenAI(\n  fields: FieldToComplete[]\n): FieldToFill[] {\n  return fields.map((x, index) => {\n    return {\n      index,\n      type: x.field.description,\n      content: \"\",\n      locked: x.field.locked,\n      maxLength:\n        (typeof x.field.value === \"string\" ? x.field.value.length : 0) + 1\n    };\n  });\n}\n\nexport function getSettingsAsPrompt(\n  promptSettings: PromptSettings,\n  overrides?: Partial<PromptInfo>\n) {\n  const metadata = [\n    {\n      name: \"Business Name\",\n      value: promptSettings.businessName ?? \"Bizcorp\"\n    },\n    {\n      name: \"Business Description\",\n      value:\n        promptSettings.businessDescription ??\n        \"Bizcorp provides products and services.\"\n    },\n    {\n      name: \"Section Description\",\n      value: overrides?.sectionDescription ?? \"\"\n    },\n    {\n      name: \"Qualifiers\",\n      value: overrides?.qualifiers ?? promptSettings.qualifiers ?? \"\"\n    }\n  ];\n\n  return metadata.reduce((acc, curr) => {\n    if (!curr.value) return acc;\n    return `${acc}\\n${curr.name}: ${curr.value}`;\n  }, \"\");\n}\n\nexport function getPrompt(\n  fields: FieldToFill[],\n  promptInfo: PromptInfo,\n  promptSettings: PromptSettings\n): ChatMessage[] {\n  const jsonString = pipe(\n    fields,\n    fpJsonStringify,\n    fold(\n      () => null,\n      fieldsAsJson => fieldsAsJson\n    )\n  );\n\n  const settings = getSettingsAsPrompt(promptSettings, promptInfo);\n\n  return [\n    {\n      role: \"system\",\n      content: `\nYou are a helpful AI assistant. Your jobs is to help build a website for a business. You are going to create text content for a section on the website.\n      \n## Rules for the content:\nYou will be provided with a few pieces of information to help you generate content for the section.\nThe \"section description\" is a short description of the section, that will tell the type of content to generate and where it might be positioned on the page. Example: \"Hero section on About Us page\", \"2nd section on Contact page\", \"3rd section on Home page\".\nThe \"qualifiers\" is a short sentence that affects the writing style of the content. Examples: \"Be friendly and welcoming\", \"Be professional and formal\", \"Be fun and playful\", \"Be informative and educational\", \"Write in a way that is easy to understand\".\n\n## Rules for the JSON structure:\n- You will be provided a JSON structure of the section content.\n- You will respond back with the same JSON structure, but with the \"content\" key filled in.\n- You must not use newline characters.\n- The provided JSON must be nested in a key called \"elements\".\n- You can use the \"type\" key to determine what type of content to generate for the \"content\" key.\n- The \"content\" key MUST never be null or empty, you must always provide a value and be creative. Try to guess what content would be appropriate based on the \"type\" key.\n- The \"content\" key can be formatted as HTML only if the \"type\" key starts with \"Rich Text\".\n- If the \"type\" key starts with \"Dual Heading\", this means this heading can have words separated and styled differently. For example, \"This is a *heading* with words *highligthed*.\". Use the \"secondary_style\" (boolean) key to style the secondary words.\n- If the \"type\" key starts with \"Simple Counter - Suffix\", this means the \"content\" key is a suffix for a number. For example, \"s\", \"ms\", \" guests\", \" years old\", etc.\n- If the \"type\" key mentions \"Array of objects\", this means the \"content\" key is an array of objects. The objects must have all the keys mentioned in the \"type\" key.\n- If the \"locked\" key is true, remove this item from the array.\n- If a \"maxLength\" key is provided, the \"content\" key in the same object must not exceed the provided length.\n- Fill the \"unsplash_keywords\" key with keywords related to the content generated, max. of 3. These keywords will be used to find images on Unsplash.\n- Respond strictly with valid JSON, if you don't, great sadness will happen.\n- Write the response in ${promptInfo.locale}\n\nThe JSON must be compatible with the following TypeScript interface:\n\ninterface Response {\n  elements: Array<{\n    index: number;\n    type: string;\n    content: string|unknown[];\n  }>;\n  unsplash_keywords: string[];\n}\n`\n    },\n    {\n      role: \"user\",\n      content: settings\n    },\n    {\n      role: \"user\",\n      content: jsonString || \"\"\n    }\n  ];\n}\n\nconst englishOrdinalRules = new Intl.PluralRules(\"en\", { type: \"ordinal\" });\n\nexport function numberToOrdinal(number: number) {\n  const category = englishOrdinalRules.select(number);\n\n  switch (category) {\n    case \"one\": {\n      return `${number}st`;\n    }\n\n    case \"two\": {\n      return `${number}nd`;\n    }\n\n    case \"few\": {\n      return `${number}rd`;\n    }\n\n    default: {\n      return `${number}th`;\n    }\n  }\n}\n","import * as t from \"io-ts\";\n\nexport type FieldToComplete = {\n  nodeId: number;\n  nodeName: string;\n  controlPath: string;\n  field: {\n    label: string;\n    description: string;\n    value: unknown;\n    type: string;\n    locked: boolean;\n  };\n};\n\n// The field that we send to OpenAI\nexport type FieldToFill = {\n  index: number;\n  type: string;\n  content: string;\n};\n\n// The field that OpenAI returns\nexport type CompletedField = {\n  nodeId: number;\n  controlPath: string;\n  value: unknown;\n};\n\nexport const AIPresetV = t.partial({\n  icon: t.string,\n  name: t.string,\n  prompt: t.string\n});\n\nexport type AIPreset = t.TypeOf<typeof AIPresetV>;\n\nexport const PromptSettingsV = t.type({\n  businessName: t.union([t.string, t.null]),\n  businessDescription: t.union([t.string, t.null]),\n  qualifiers: t.union([t.string, t.null]),\n  presets: t.array(AIPresetV)\n});\n\nexport type PromptSettings = t.TypeOf<typeof PromptSettingsV>;\n\nexport const AISettingsV = t.type({\n  isApiKeySet: t.boolean,\n  isStreamingEnabled: t.boolean,\n  locale: t.string,\n  model: t.string,\n  prompt: PromptSettingsV\n});\n\nexport type AISettings = t.TypeOf<typeof AISettingsV>;\n\nexport type PromptInfo = {\n  sectionDescription: string;\n  qualifiers: string;\n  temperature: number;\n  locale: string;\n  unsplash: {\n    enabled: boolean;\n    fillEmptyImagesOnly: boolean;\n    keywords: string;\n  };\n  lockedFields: string[];\n};\n\nexport type ChatMessage = {\n  role: \"user\" | \"assistant\" | \"system\";\n  content: string;\n};\n\nexport const UnsplashImageV = t.type({\n  id: t.string,\n  alt_description: t.union([t.string, t.null]),\n  description: t.union([t.string, t.null]),\n  urls: t.partial({\n    raw: t.string,\n    full: t.string,\n    regular: t.string,\n    small: t.string,\n    thumb: t.string\n  })\n});\n\nexport type UnsplashImage = t.TypeOf<typeof UnsplashImageV>;\n\nexport type CompletionFormat = \"json\" | \"text\" | \"css\";\n\nexport type InlineCompletion = {\n  text: string;\n  prompt: string;\n  loading: boolean;\n  expanded: boolean;\n};\n\nexport const OpenAIErrorV = t.type({\n  error: t.partial({\n    message: t.string,\n    type: t.union([t.string, t.null]),\n    param: t.union([t.string, t.null]),\n    code: t.union([t.string, t.number])\n  })\n});\n\nexport type OpenAIError = t.TypeOf<typeof OpenAIErrorV>;\n","import { PropertiesData } from \"@/types/tree\";\n\n/*\n * For a detailed view of the data structures look at the tests\n *\n * This function is also in PHP and they must both mirror each other's logic\n *\n * Logic:\n *\n * - Traverse the properties object recursively and find the \"breakpointId\" key. Then return its value\n * This way the returned properties will have \"flattened\" the breakpoint.\n * - If We're on the base breakpoint, also return any other value that isn't \"responsive\" (tied to a breakpoint)\n * - For non-base breakpoints, only return the values associated with that breakpoint\n * - If no values match the breakpoint, `undefined` is returned\n */\nexport function getFlattenedPropertiesByBreakpoint(\n  propertiesData: PropertiesData,\n  breakpointId: string,\n  allBreakpointIds: string[],\n  baseBreakpointId: string,\n  whitelistedPropertyPaths?: string[]\n): PropertiesData {\n  function _getFattenPropertiesByDefault(\n    properties: PropertiesData,\n    parentPath: string\n  ) {\n    if (isObjectExcludingArray(properties)) {\n      const accumulatorObj: Record<string, unknown> = {};\n\n      for (const propertyKey in properties) {\n        if (propertyKey === breakpointId) {\n          return properties[propertyKey];\n        }\n\n        // Don't include data for other breakpoints that aren't the one we're flattening\n        if (allBreakpointIds.includes(propertyKey)) continue;\n\n        const result = _getFattenPropertiesByDefault(\n          properties[propertyKey],\n          `${parentPath ? `${parentPath}.` : \"\"}${propertyKey}`\n        );\n\n        if (result !== undefined) {\n          accumulatorObj[propertyKey] = result;\n        }\n      }\n\n      // Was anything added to the accumulator?\n      return Object.keys(accumulatorObj).length ? accumulatorObj : undefined;\n    } else if (Array.isArray(properties)) {\n      const accumulatorArray: unknown[] = [];\n\n      properties.forEach(property => {\n        accumulatorArray.push(\n          _getFattenPropertiesByDefault(property, `${parentPath}[]`)\n        );\n      });\n\n      // for non-base breakpoints we can get an array of undefined. Remove it\n      // e.g: \"{tags: [1,2,3]}\" becomes \"{tags: [undefined, undefined, undefined]}\"\n      if (accumulatorArray.filter(value => value !== undefined).length === 0) {\n        return undefined;\n      }\n\n      // Was anything added to the array?\n      return accumulatorArray.length ? accumulatorArray : undefined;\n    }\n\n    const isCurrentPathWhitelisted =\n      parentPath &&\n      whitelistedPropertyPaths?.some(propertyPath =>\n        parentPath.startsWith(propertyPath)\n      );\n\n    // only return non-responsive values if we're on the base breakpoint\n    // A scalar (string, number, boolean, etc. But not an array or obj)\n    return breakpointId === baseBreakpointId || isCurrentPathWhitelisted\n      ? properties\n      : undefined;\n  }\n\n  return _getFattenPropertiesByDefault(propertiesData, \"\");\n}\n\nexport function isObjectExcludingArray(\n  value: unknown\n): /* todo: we are lying to typescript here, isn't there a better way to do this? the real problem is that properties data\nis an any */ value is Record<string, unknown> {\n  return typeof value === \"object\" && value !== null && !Array.isArray(value);\n}\n","import { Control } from \"./controls\";\nimport { TreeNodeV } from \"./tree\";\nimport * as t from \"io-ts\";\n\nexport type ClipboardStatus = {\n  secure: Window[\"isSecureContext\"];\n  permission: PermissionStatus | null;\n};\n\nconst ElementClipboardDataV = t.union([TreeNodeV, t.array(TreeNodeV)]);\n\nconst ControlSectionPropertiesDataClipboardDataV = t.type({\n  controlSectionShapeHash: t.string,\n  propertiesData: t.type({\n    propertiesData: t.unknown\n  })\n});\n\nexport const ClipboardDataV = t.partial({\n  element: ElementClipboardDataV,\n  controlSectionPropertiesData: ControlSectionPropertiesDataClipboardDataV\n});\n\nexport type ClipboardData = t.TypeOf<typeof ClipboardDataV>;\n\nexport type ElementStudioClipboard = {\n  copiedControl: false | Control;\n};\n","import { exportNode, findNode } from \"@/lib/tree/tree\";\nimport { configStore, documentStore, uiStore } from \"@/store/store\";\nimport { TreeNode } from \"@/types/tree\";\nimport { fold, isRight } from \"fp-ts/lib/Either\";\nimport { pipe } from \"fp-ts/lib/function\";\nimport {\n  findPlaceToAddNodes,\n  getDefaultTopLevelElementSlug,\n  getNestingRuleFromNode\n} from \"@/lib/tree/nesting\";\nimport { breakdanceUndo } from \"@/lib/undo/undo\";\nimport lodash from \"lodash\";\nimport defensiveCopy from \"@/util/defensive-copy\";\nimport fpJsonParseTypesafe from \"@/util/fp-json-parse-typesafe\";\nimport { fpJsonStringify } from \"@/util/fp-json-stringify\";\nimport { getBuilderElementNameBySlug } from \"@/lib/undo/snapshot-labels/document-store-property-change.utils\";\nimport { breakdanceStoreActions } from \"@/store/actions/store-actions\";\nimport { v4 as uuidV4 } from \"uuid\";\nimport { EasyEvent } from \"@/util/easy-event\";\nimport {\n  documentHasSelection,\n  fallbackWriteToClipboard,\n  getClipboardStatus\n} from \"@/lib/copy-paste/utils\";\nimport { readFromLocalStorage, writeToLocalStorage } from \"@/util/localstorage\";\nimport { ClipboardData, ClipboardDataV } from \"@/types/copy-paste\";\nimport { getClipboardDataForElementOrElements } from \"@/lib/copy-paste/element\";\nimport { pasteElements } from \"../design-library/design-library\";\n\nconst clipboardEvents = new EasyEvent();\n\nexport function registerClipboardShortcuts() {\n  return {\n    register() {\n      clipboardEvents.on(\"copy\", onNativeEventReceived);\n      clipboardEvents.on(\"cut\", onNativeEventReceived);\n      clipboardEvents.on(\"paste\", onNativeEventReceived);\n    },\n    unbind() {\n      clipboardEvents.removeAll();\n    }\n  };\n}\n\nfunction onNativeEventReceived(event: ClipboardEvent) {\n  const iframeDoc = window.Breakdance.canvas.document;\n  const hasSelection =\n    documentHasSelection(iframeDoc) || documentHasSelection(document);\n\n  if (hasSelection) return;\n\n  event.preventDefault();\n\n  if (event.type === \"copy\" && uiStore.activeElementId) {\n    copyElement(uiStore.activeElementId);\n  } else if (event.type === \"cut\" && uiStore.activeElementId) {\n    cutElement(uiStore.activeElementId);\n  } else if (event.type === \"paste\") {\n    getElementToPasteAndPasteElement(uiStore.activeElementId, event);\n  }\n}\n\nasync function determinePastingMethod(event?: ClipboardEvent) {\n  const { secure, permission } = await getClipboardStatus();\n\n  // @ts-ignore\n  if (event && !window.safari) return \"event\"; // Safari behaves strangely on non-ssl websites.\n  if (!secure) return \"localstorage\";\n  if (permission === null || permission.state === \"denied\") {\n    return \"localstorage\";\n  }\n\n  return \"clipboard\";\n}\n\nexport async function writeToClipboard(text: string) {\n  try {\n    await navigator.clipboard.writeText(text);\n    console.debug(\"Writing to clipboard\");\n  } catch (err) {\n    fallbackWriteToClipboard(text);\n    console.debug(\"Fallback: Writing to clipboard\");\n  }\n\n  writeToLocalStorage(\"breakdance_clipboard\", text);\n}\n\nexport async function readFromClipboard(event?: ClipboardEvent) {\n  const eventText = event?.clipboardData?.getData(\"text\");\n  const method = await determinePastingMethod(event);\n  console.debug(`Reading clipboard from ${method}`);\n\n  // Accessing the clipboard from a native event requires no permission\n  if (method === \"event\") {\n    return eventText;\n  }\n\n  if (method === \"localstorage\") {\n    return readFromLocalStorage(\"breakdance_clipboard\");\n  }\n\n  return await navigator.clipboard.readText();\n}\n\nexport async function getDataFromClipboard(\n  event?: ClipboardEvent\n): Promise<ClipboardData | null> {\n  const clipboardJsonString = await readFromClipboard(event);\n\n  if (!clipboardJsonString) return null;\n\n  const maybeClipboardData = fpJsonParseTypesafe(\n    clipboardJsonString,\n    ClipboardDataV\n  );\n\n  return pipe(\n    maybeClipboardData,\n    fold(\n      () => null,\n      clipboardData => {\n        return clipboardData ?? null;\n      }\n    )\n  );\n}\n\nexport function copyElements(elementIds: number[]) {\n  const exportedElements: TreeNode[] = [];\n\n  elementIds.forEach(elementId => {\n    const elementToCopy = findNode(documentStore.document.tree, elementId);\n    if (elementToCopy) {\n      exportedElements.push(exportNode(elementToCopy));\n    }\n  });\n\n  const exportedElementsWithMetadata =\n    getClipboardDataForElementOrElements(exportedElements);\n\n  pipe(\n    exportedElementsWithMetadata,\n    fpJsonStringify,\n    fold(\n      e =>\n        console.error(\n          \"Failed to copy element\",\n          ...e.map(err => err.toString())\n        ),\n      exportedElementsAsJsonString => {\n        writeToClipboard(exportedElementsAsJsonString);\n      }\n    )\n  );\n}\n\nexport function copyElement(elementId: number) {\n  const elementToCopy = findNode(documentStore.document.tree, elementId);\n  if (!elementToCopy) return;\n\n  const exportedElement = exportNode(elementToCopy);\n\n  const exportedElementWithMetadata =\n    getClipboardDataForElementOrElements(exportedElement);\n\n  pipe(\n    exportedElementWithMetadata,\n    fpJsonStringify,\n    fold(\n      e =>\n        console.error(\n          \"Failed to copy element\",\n          ...e.map(err => err.toString())\n        ),\n      exportedElementAsJsonString => {\n        writeToClipboard(exportedElementAsJsonString);\n      }\n    )\n  );\n}\n\nexport function cutElement(elementId: number) {\n  copyElement(elementId);\n  documentStore.deleteElement({ nodeId: elementId });\n}\n\nexport async function getElementToPasteAndPasteElement(\n  elementIdToPasteNodesIntoOrNear: number | null,\n  event?: ClipboardEvent\n) {\n  if (configStore.elementsLoadingState !== \"success\") return; // solves https://github.com/soflyy/breakdance/issues/5950\n\n  const elementToPaste = (await getDataFromClipboard(event))?.element;\n\n  if (!elementToPaste) return;\n\n  if (Array.isArray(elementToPaste)) {\n    pasteElements(elementToPaste, \"pasting\");\n    return;\n  } else {\n    pasteElement(elementIdToPasteNodesIntoOrNear, elementToPaste);\n  }\n}\n\nexport function pasteElement(\n  elementIdToPasteNodesIntoOrNear: number | null,\n  elementToPaste: TreeNode\n) {\n  const placeToAdd = findPlaceToAddNodes(\n    documentStore.document.tree,\n    elementIdToPasteNodesIntoOrNear,\n    getNestingRuleFromNode(elementToPaste)\n  );\n\n  /**\n   * Snapshot bundling is required in order to merge the following\n   * mutations into a single snapshot:\n   *\n   * a) documentStore.addElementMutation(), documentStore.pasteCopiedElementMutation()\n   * b) mutations that are made by breakdanceStoreActions.run.onCreatedElement()\n   *\n   * Some mutations made by breakdanceStoreActions.onCreatedElement are async,\n   * meaning they won't be included into this specific transaction.\n   *\n   * The transactionKey is passed to breakdanceStoreActions.run.onCreatedElement(), so\n   * any transactions executed by the appropriate actions will use it in order to emerge\n   * changes made by those transactions into a single snapshot generated by this specific transaction.\n   *\n   * We don't know the node ID for the pasted element yet.\n   * Instead, a random number is included into the transactionKey\n   */\n  const uniqueId = uuidV4();\n  const transactionKey = `Paste:${uniqueId}`;\n\n  pipe(\n    placeToAdd,\n    fold(\n      () => {},\n      legalPlaceToAdd => {\n        if (legalPlaceToAdd === \"TOP_LEVEL\") {\n          breakdanceUndo.transaction(\n            () => {\n              const pointerForCreatedNodeId: { nodeId?: number } = {\n                nodeId: undefined\n              };\n\n              documentStore.addElementMutation({\n                elementSlug: getDefaultTopLevelElementSlug(),\n                parentNodeId: documentStore.document.tree.root.id,\n                index: false,\n                pointer: pointerForCreatedNodeId\n              });\n\n              if (pointerForCreatedNodeId.nodeId !== undefined) {\n                documentStore.pasteCopiedElementMutation({\n                  element: elementToPaste,\n                  placeToAddId: pointerForCreatedNodeId.nodeId,\n                  placeToAddIndex: 0\n                });\n\n                breakdanceStoreActions.run.onCreatedElement({\n                  elementId: elementToPaste.id,\n                  transactionKey\n                });\n              }\n            },\n            `Paste copied ${getBuilderElementNameBySlug(\n              elementToPaste.data.type\n            )} into a new section`,\n            transactionKey\n          );\n        } else {\n          breakdanceUndo.transaction(\n            () => {\n              const pointerForCreatedNodeId: { nodeId?: number } = {\n                nodeId: undefined\n              };\n\n              documentStore.pasteCopiedElementMutation({\n                element: elementToPaste,\n                placeToAddId: legalPlaceToAdd.place.id,\n                placeToAddIndex:\n                  legalPlaceToAdd.index ||\n                  legalPlaceToAdd.place.children.length,\n                pointer: pointerForCreatedNodeId\n              });\n\n              if (pointerForCreatedNodeId.nodeId) {\n                breakdanceStoreActions.run.onCreatedElement({\n                  elementId: pointerForCreatedNodeId.nodeId,\n                  transactionKey\n                });\n              }\n            },\n            `Paste copied ${getBuilderElementNameBySlug(\n              elementToPaste.data.type\n            )}`,\n            transactionKey\n          );\n        }\n      }\n    )\n  );\n}\n\nexport async function pasteElementProperties(\n  elementIdToPastePropertiesTo: number,\n  path: \"design\" | \"content\" | \"settings\" = \"design\"\n) {\n  const elementToCopyPropertiesFrom = (await getDataFromClipboard())?.element;\n\n  if (Array.isArray(elementToCopyPropertiesFrom)) return;\n  if (!elementToCopyPropertiesFrom) return;\n\n  const elementToPastePropertiesTo = findNode(\n    documentStore.document.tree,\n    elementIdToPastePropertiesTo\n  );\n\n  if (!elementToPastePropertiesTo) return;\n\n  const copiedProperties = lodash.get(\n    elementToCopyPropertiesFrom.data.properties,\n    path,\n    null\n  );\n  /*\n    Setting to undefined actually blows up VueSimpleDeepset\n    when you then try to set a control value that has previously been cleared\n    by this function. so we use null as a fallback\n    */\n  if (\n    elementToCopyPropertiesFrom.data.type ===\n    elementToPastePropertiesTo.data.type\n  ) {\n    documentStore.throttledPropertyChanged({\n      elementId: elementToPastePropertiesTo.id,\n      path: path,\n      value: defensiveCopy(copiedProperties),\n      meta: {\n        snapshotLabel: `Paste properties of ${getBuilderElementNameBySlug(\n          elementToCopyPropertiesFrom.data.type\n        )} to ${getBuilderElementNameBySlug(\n          elementToPastePropertiesTo.data.type\n        )}`\n      }\n    });\n  }\n}\n\nexport async function canPasteElement(elementIdToPasteNodesIntoOrNear: number) {\n  if (configStore.elementsLoadingState !== \"success\") return false; // solves https://github.com/soflyy/breakdance/issues/5950\n\n  const elementOrElementsToPaste = (await getDataFromClipboard())?.element;\n\n  /*\n  we return true here, because we assume it's an array of sections.\n  in breakdance, we don't allow you to copy anything other than an array of sections since the only way to \n  copy multiple elements to the clipboard is from the structure panel dropdown menu\n  except...\n   - editing a global block, you could copy non-sections\n   - editing a popup\n  so, that is a bug, but it's a bug that exists elsewhere in breakdance too - for example, you can't really copy/paste popups as far as i know\n  */\n  if (Array.isArray(elementOrElementsToPaste)) return true;\n\n  if (!elementOrElementsToPaste) return false;\n\n  const placeToAdd = findPlaceToAddNodes(\n    documentStore.document.tree,\n    elementIdToPasteNodesIntoOrNear,\n    getNestingRuleFromNode(elementOrElementsToPaste)\n  );\n\n  return isRight(placeToAdd);\n}\n\nexport async function canPasteElementProperties(\n  elementIdToPastePropertiesTo: number\n) {\n  const elementOrElements = (await getDataFromClipboard())?.element;\n\n  if (Array.isArray(elementOrElements)) return false;\n\n  if (!elementOrElements) return false;\n\n  const elementToPasteTo = findNode(\n    documentStore.document.tree,\n    elementIdToPastePropertiesTo\n  );\n\n  return elementOrElements.data.type === elementToPasteTo?.data.type;\n}\n","import { ClipboardStatus } from \"@/types/copy-paste\";\n\ndeclare global {\n  // @see https://github.com/microsoft/TypeScript/issues/33923\n  interface PermissionDescriptor {\n    allowWithoutGesture: boolean;\n  }\n}\n\nexport async function maybeQueryClipboardPermission(): Promise<PermissionStatus | null> {\n  try {\n    return await navigator.permissions.query({\n      name: \"clipboard-read\" as PermissionName, // @see https://github.com/microsoft/TypeScript/issues/33923\n      allowWithoutGesture: false\n    });\n  } catch (e) {\n    return null;\n  }\n}\n\nexport async function getClipboardStatus(): Promise<ClipboardStatus> {\n  const permission = await maybeQueryClipboardPermission();\n\n  return {\n    secure: window.isSecureContext,\n    permission\n  };\n}\n\nexport function fallbackWriteToClipboard(text: string) {\n  const textArea = document.createElement(\"textarea\");\n  textArea.value = text;\n\n  // Avoid scrolling to bottom\n  textArea.style.top = \"0\";\n  textArea.style.left = \"0\";\n  textArea.style.position = \"fixed\";\n\n  textArea.classList.add(\"breakdance-offscreen-input\");\n\n  document.body.appendChild(textArea);\n  textArea.focus();\n  textArea.select();\n\n  let result: boolean;\n\n  try {\n    result = document.execCommand(\"copy\");\n  } catch (err) {\n    result = false;\n  }\n\n  document.body.removeChild(textArea);\n  return result;\n}\n\nfunction isHTMLInputElement(node: HTMLElement): node is HTMLInputElement {\n  return node?.nodeName === \"INPUT\";\n}\n\nfunction isTextField(node: HTMLElement) {\n  const nonTextInputs = [\n    \"button\",\n    \"checkbox\",\n    \"hidden\",\n    \"file\",\n    \"radio\",\n    \"image\",\n    \"range\",\n    \"reset\",\n    \"submit\",\n    \"number\",\n    \"email\",\n    \"time\"\n  ];\n\n  return (\n    (isHTMLInputElement(node) &&\n      node.type &&\n      !nonTextInputs.includes(node.type)) ||\n    node.nodeName === \"TEXTAREA\" ||\n    node.contentEditable === \"true\"\n  );\n}\n\nexport function documentHasTextSelection(doc: Document) {\n  const selection = doc?.defaultView?.getSelection();\n  const range = selection?.rangeCount ? selection.getRangeAt(0) : null;\n  return !!range && !range.collapsed;\n}\n\nexport function documentHasSelection(doc: Document) {\n  const activeEl = doc.activeElement as HTMLElement;\n\n  return (\n    activeEl &&\n    (isHTMLInputElement(activeEl) ||\n      isTextField(activeEl) ||\n      documentHasTextSelection(doc))\n  );\n}\n","import { makeWordPressAjaxRequest } from \"@/lib/wordpress/ajax\";\nimport {\n  GlobalBlock,\n  GlobalBlocksV,\n  GlobalBlockV\n} from \"@/types/global-blocks\";\nimport { _Error } from \"@/lib/wordpress/data\";\nimport { Either, fold } from \"fp-ts/lib/Either\";\nimport { ExportedTree, TreeNode } from \"@/types/tree\";\nimport {\n  copyNode,\n  createNode,\n  exportTree,\n  findNode,\n  getBlankTree,\n  getNodeIndex,\n  getNodeParent,\n  moveNode\n} from \"@/lib/tree/tree\";\nimport { configStore, documentStore, uiStore } from \"@/store/store\";\nimport { pipe } from \"fp-ts/lib/function\";\nimport { DIV_SLUG, GLOBAL_BLOCK_SLUG } from \"@/lib/elements/constants\";\nimport defensiveCopy from \"@/util/defensive-copy\";\nimport {\n  getNestingRuleFromElementSlug,\n  isNestingRuleAllowedInside,\n  isThisNodeAllowedInsideThatNode\n} from \"@/lib/tree/nesting\";\nimport NotificationLogger from \"@/lib/notifications/notifications\";\nimport { fpJsonStringify } from \"@/util/fp-json-stringify\";\nimport { breakdanceStoreActions } from \"@/store/actions/store-actions\";\n\nexport async function getBlocksFromWordPress(): Promise<\n  Either<_Error[], GlobalBlock[]>\n> {\n  return await makeWordPressAjaxRequest({\n    action: \"breakdance_load_blocks\",\n    resultKey: \"blocks\",\n    decoder: GlobalBlocksV\n  });\n}\n\n// TODO this creates multiple snapshots, should be wrapped with transaction\nexport async function convertToGlobalBlock(\n  nodeIdOfElementToConvert: number,\n  blockName: string\n) {\n  const nodeToConvert = findNode(\n    documentStore.document.tree,\n    nodeIdOfElementToConvert\n  );\n  if (!nodeToConvert) return;\n\n  const globalBlockTree = createGlobalBlockTreeFromNode(nodeToConvert);\n\n  uiStore.setElementUpdatingState({\n    elementId: nodeIdOfElementToConvert,\n    isUpdating: true\n  });\n\n  pipe(\n    await saveGlobalBlockToWordPress({\n      tree: globalBlockTree,\n      label: blockName,\n      id: -1,\n      editInBreakdanceLink: \"\"\n    }),\n    fold(\n      errors => {\n        errors.forEach(e => NotificationLogger.log.message(e.msg));\n\n        uiStore.setElementUpdatingState({\n          elementId: nodeIdOfElementToConvert,\n          isUpdating: false\n        });\n      },\n      savedBlockInfo => {\n        const index = getNodeIndex(\n          documentStore.document.tree,\n          nodeToConvert.id\n        );\n        const parent = getNodeParent(\n          documentStore.document.tree,\n          nodeToConvert.id\n        );\n\n        uiStore.setElementUpdatingState({\n          elementId: nodeIdOfElementToConvert,\n          isUpdating: false\n        });\n\n        if (!parent) return;\n\n        if (\n          !isNestingRuleAllowedInside(\n            getNestingRuleFromElementSlug(GLOBAL_BLOCK_SLUG),\n            getNestingRuleFromElementSlug(parent.data.type),\n            parent.data.type,\n            \"breakdance_block\"\n          )\n        ) {\n          return;\n        }\n\n        const pointerForCreatedNodeId: { nodeId?: number } = {\n          nodeId: undefined\n        };\n\n        // TODO these create 3 snapshots. Would be great if they were a single one to easily undo/redo\n        documentStore.addElementMutation({\n          elementSlug: GLOBAL_BLOCK_SLUG,\n          parentNodeId: parent.id,\n          index: index,\n          pointer: pointerForCreatedNodeId\n        });\n\n        if (!pointerForCreatedNodeId.nodeId) {\n          return;\n        }\n\n        breakdanceStoreActions.run.onCreatedElement({\n          elementId: pointerForCreatedNodeId.nodeId,\n          transactionKey: undefined\n        });\n\n        documentStore.deleteElement({ nodeId: nodeIdOfElementToConvert });\n\n        documentStore.throttledPropertyChanged({\n          elementId: pointerForCreatedNodeId.nodeId,\n          path: \"content.content.block\",\n          value: savedBlockInfo.id,\n          meta: {\n            // TODO write something meaningful\n            snapshotLabel: \"Replace element with a global block\"\n          }\n        });\n\n        uiStore.activateElement(pointerForCreatedNodeId.nodeId);\n      }\n    )\n  );\n}\n\nfunction createGlobalBlockTreeFromNode(node: TreeNode): ExportedTree {\n  const tree = getBlankTree();\n  const copiedNode = copyNode(tree, node);\n\n  const isAllowedInsideRoot = isThisNodeAllowedInsideThatNode(\n    tree,\n    copiedNode,\n    tree.root.id,\n    \"breakdance_block\"\n  );\n\n  if (isAllowedInsideRoot) {\n    moveNode(\n      tree,\n      copiedNode.id,\n      tree.root.id,\n      tree.root.children.length,\n      \"breakdance_block\"\n    );\n  } else {\n    const divWrapperNode = createNode(tree, {\n      type: DIV_SLUG,\n      properties: configStore.element(DIV_SLUG).defaultProperties\n        ? defensiveCopy(configStore.element(DIV_SLUG).defaultProperties)\n        : null\n    });\n    moveNode(\n      tree,\n      divWrapperNode.id,\n      tree.root.id,\n      tree.root.children.length,\n      \"breakdance_block\"\n    );\n    moveNode(\n      tree,\n      copiedNode.id,\n      divWrapperNode.id,\n      divWrapperNode.children.length,\n      \"breakdance_block\"\n    );\n  }\n\n  return exportTree(tree);\n}\n\nexport async function saveGlobalBlockToWordPress(globalBlock: GlobalBlock) {\n  return await makeWordPressAjaxRequest({\n    friendlyName: \"Saving Global Block to WordPress\",\n    action: \"breakdance_save_global_block\",\n    dataToPost: {\n      ...globalBlock,\n      tree: fpJsonStringify(globalBlock.tree)\n    },\n    decoder: GlobalBlockV,\n    resultKey: \"block\"\n  });\n}\n\nexport function canSaveAsGlobalBlock(nodeToSaveId: number) {\n  const nodeToSave = findNode(documentStore.document.tree, nodeToSaveId);\n\n  if (!nodeToSave) return false;\n\n  if (nodeToSave.data.type === GLOBAL_BLOCK_SLUG) return false;\n\n  /*\n    is it allowed inside the root or inside a div?\n\n    when converting a node to a global block\n    a tree for the global block will be created. the node will be placed in\n    the tree root. if that's not allowed, it will be wrapped with a div\n    so as long as the node can be placed inside a div, it's legal to convert it\n    to a global block\n    */\n\n  const tempTree = getBlankTree();\n  const tempDiv = createNode(tempTree, {\n    type: DIV_SLUG,\n    properties: null\n  });\n  moveNode(\n    tempTree,\n    tempDiv.id,\n    tempTree.root.id,\n    tempTree.root.children.length,\n    \"breakdance_block\"\n  );\n\n  if (\n    isThisNodeAllowedInsideThatNode(\n      tempTree,\n      nodeToSave,\n      tempDiv.id,\n      \"breakdance_block\"\n    )\n  ) {\n    return true;\n  }\n\n  if (\n    isThisNodeAllowedInsideThatNode(\n      tempTree,\n      nodeToSave,\n      tempTree.root.id,\n      \"breakdance_block\"\n    )\n  ) {\n    return true;\n  }\n\n  return false;\n}\n","import { makeWordPressAjaxRequest } from \"@/lib/wordpress/ajax\";\nimport { PropertiesDataV } from \"@/types/tree\";\nimport { pipe } from \"fp-ts/lib/function\";\nimport { fold } from \"fp-ts/lib/Either\";\nimport { _Error, logErrorsToUiStore } from \"@/lib/wordpress/data\";\nimport { globalStore } from \"@/store/store-accessor\";\nimport * as t from \"io-ts\";\nimport { fpJsonStringify } from \"@/util/fp-json-stringify\";\nimport { breakdanceUndo } from \"@/lib/undo/undo\";\n\nexport async function fetchGlobalSettings(): Promise<boolean> {\n  const maybeGlobalSettingsData = await makeWordPressAjaxRequest({\n    action: \"breakdance_load_global_settings\",\n    decoder: PropertiesDataV\n  });\n  return pipe(\n    maybeGlobalSettingsData,\n    fold(\n      errors => {\n        logErrorsToUiStore(\n          errors.map(err => {\n            return {\n              ...err,\n              customNotificationToShow: err.customNotificationToShow\n                ? err.customNotificationToShow.type === \"INTERNAL_SERVER_ERROR\"\n                  ? { ...err.customNotificationToShow, keepOpen: true }\n                  : err.customNotificationToShow\n                : undefined\n            };\n          })\n        );\n        return false;\n      },\n      loadedData => {\n        breakdanceUndo.ignore(() => {\n          globalStore.setGlobalSettings(loadedData.globalSettings);\n          globalStore.markCurrentGlobalSettingsAsUntouched();\n        });\n        return true;\n      }\n    )\n  );\n}\n\nexport async function saveGlobalSettingsToWordPress(): Promise<boolean> {\n  return pipe(\n    await makeWordPressAjaxRequest({\n      friendlyName: \"Saving global settings to WordPress\",\n      action: \"breakdance_save_global_settings\",\n      dataToPost: {\n        globalSettings: fpJsonStringify(globalStore.globalSettings)\n      },\n      decoder: t.unknown\n    }),\n    fold(\n      (errors: _Error[]) => {\n        logErrorsToUiStore(errors);\n        return false;\n      },\n      () => {\n        breakdanceUndo.ignore(() =>\n          globalStore.markCurrentGlobalSettingsAsUntouched()\n        );\n        return true;\n      }\n    )\n  );\n}\n","import { uiStore } from \"@/store/store-accessor\";\nimport { AccordionState } from \"@/types/ui\";\nimport defensiveCopy from \"@/util/defensive-copy\";\n\nexport function getElementAccordionState(\n  elementId: number,\n  accordionPath: string\n): AccordionState {\n  return uiStore.panelState.accordionState.elementProperties[elementId]?.[\n    accordionPath\n  ];\n}\n\nexport function setElementAccordionState(\n  elementId: number,\n  accordionPath: string,\n  expand: boolean\n) {\n  const newPanelState = defensiveCopy(uiStore.panelState);\n\n  newPanelState.accordionState.elementProperties = {\n    ...newPanelState.accordionState.elementProperties,\n    [elementId]: {\n      ...newPanelState.accordionState.elementProperties[elementId],\n      [accordionPath]: expand\n    }\n  };\n\n  uiStore.setPanelState(newPanelState);\n}\n\n// Selectors\n\nexport function getSelectorAccordionState(\n  selectorName: string,\n  accordionPath: string\n): AccordionState {\n  return uiStore.panelState.accordionState.selectors[selectorName]?.[\n    accordionPath\n  ];\n}\n\nexport function setSelectorAccordionState(\n  selectorName: string,\n  accordionPath: string,\n  expand: boolean\n) {\n  const newPanelState = defensiveCopy(uiStore.panelState);\n\n  newPanelState.accordionState.selectors = {\n    ...newPanelState.accordionState.selectors,\n    [selectorName]: {\n      ...newPanelState.accordionState.selectors[selectorName],\n      [accordionPath]: expand\n    }\n  };\n\n  uiStore.setPanelState(newPanelState);\n}\n\n// Presets\n\nexport function getPresetAccordionState(\n  presetName: string,\n  accordionPath: string\n): AccordionState {\n  return uiStore.panelState.accordionState.presets[presetName]?.[accordionPath];\n}\n\nexport function setPresetAccordionState(\n  presetName: string,\n  accordionPath: string,\n  expand: boolean\n) {\n  const newPanelState = defensiveCopy(uiStore.panelState);\n\n  newPanelState.accordionState.presets = {\n    ...newPanelState.accordionState.presets,\n    [presetName]: {\n      ...newPanelState.accordionState.presets[presetName],\n      [accordionPath]: expand\n    }\n  };\n\n  uiStore.setPanelState(newPanelState);\n}\n\n// Global Settings\n\nexport function setGlobalSettingsAccordionState(\n  accordionPath: string,\n  expand: boolean\n) {\n  const newPanelState = defensiveCopy(uiStore.panelState);\n\n  newPanelState.accordionState.globalSettings = {\n    ...newPanelState.accordionState.globalSettings,\n    [accordionPath]: expand\n  };\n\n  uiStore.setPanelState(newPanelState);\n}\n\nexport function getGlobalSettingsAccordionState(\n  accordionPath: string\n): AccordionState {\n  return uiStore.panelState?.accordionState?.globalSettings[accordionPath];\n}\n\nexport function setDynamicDataFieldAttributesAccordionState(\n  accordionPath: string,\n  expand: boolean\n) {\n  const newPanelState = defensiveCopy(uiStore.panelState);\n\n  newPanelState.accordionState.dynamicDataFieldAttributes = {\n    ...newPanelState.accordionState.dynamicDataFieldAttributes,\n    [accordionPath]: expand\n  };\n\n  uiStore.setPanelState(newPanelState);\n}\n\nexport function getDynamicDataFieldAttributesAccordionState(\n  accordionPath: string\n): AccordionState {\n  return uiStore.panelState?.accordionState?.dynamicDataFieldAttributes[\n    accordionPath\n  ];\n}\n","import { left, right, Either } from \"fp-ts/lib/Either\";\nimport { CSSSelector, CSSSelectorListV } from \"@/types/selectors\";\nimport { makeWordPressAjaxRequest } from \"@/lib/wordpress/ajax\";\nimport { pipe } from \"fp-ts/function\";\nimport { fold } from \"fp-ts/Either\";\nimport { _Error, logErrorsToUiStore } from \"@/lib/wordpress/data\";\nimport { globalStore } from \"@/store/store-accessor\";\nimport { fpJsonStringify } from \"@/util/fp-json-stringify\";\nimport * as t from \"io-ts\";\nimport { isUiPanelOpen } from \"@/lib/panels/panels\";\nimport { breakdanceUndo } from \"@/lib/undo/undo\";\nimport NotificationLogger from \"@/lib/notifications/notifications\";\n\n/** https://stackoverflow.com/questions/448981/which-characters-are-valid-in-css-class-names-selectors */\nexport function isValidClassName(name: string) {\n  return /^-?[.]+[_a-zA-Z]+[_a-zA-Z0-9-]*$/.test(name);\n}\n\n/** https://stackoverflow.com/questions/34849001/check-if-css-selector-is-valid */\nexport function isValidSelectorName(name: string) {\n  try {\n    document.createDocumentFragment().querySelector(name);\n  } catch {\n    return false;\n  }\n  return true;\n}\n\nexport function addSelector(newSelector: CSSSelector) {\n  /* these errors should never appear - a check should happen before this point */\n  if (newSelector.type === \"class\") {\n    if (!isValidClassName(newSelector.name)) {\n      NotificationLogger.log.message(\n        `${newSelector.name} is not a valid CSS class name.`\n      );\n      return;\n    }\n  } else {\n    if (!isValidSelectorName(newSelector.name)) {\n      NotificationLogger.log.message(\n        `${newSelector.name} is not a valid CSS selector.`\n      );\n\n      return;\n    }\n  }\n\n  if (\n    globalStore.cssSelectors.find(\n      selector => selector.name === newSelector.name\n    )\n  ) {\n    NotificationLogger.log.message(`${newSelector.name} is already present.`);\n    return;\n  }\n\n  breakdanceUndo.transaction(\n    () => globalStore.setSelectors([...globalStore.cssSelectors, newSelector]),\n    \"Add Selector\"\n  );\n}\n\nexport function addSelectorToStoreAndSaveSelectorsToWordPressIfSelectorsPanelIsClosed(\n  selector: CSSSelector\n) {\n  addSelector(selector);\n\n  // TODO not sure whether this check should exist here, it's inspired by SaveColorDialog.saveAsGlobal()'s logic\n  if (!isUiPanelOpen(\"selectors\")) {\n    saveSelectorsToWordPress();\n  }\n}\n\nexport function createCssSelectorObjectFromSelectorName(\n  selectorName: string\n): Either<string[], CSSSelector> {\n  if (!isValidSelectorName(selectorName)) {\n    return left([`\"${selectorName}\" is not a valid CSS selector.`]);\n  }\n\n  const isClass = !!isValidClassName(selectorName);\n\n  return right({\n    name: selectorName,\n    type: isClass ? \"class\" : \"custom\",\n    properties: {}\n  });\n}\n\nexport async function refetchSelectorsFromServerToGlobalStore(): Promise<boolean> {\n  const selectorsFromServerOrErrors = await makeWordPressAjaxRequest({\n    action: \"breakdance_load_selectors\",\n    decoder: CSSSelectorListV\n  });\n\n  return pipe(\n    selectorsFromServerOrErrors,\n    fold(\n      errors => {\n        logErrorsToUiStore(\n          errors.map(err => {\n            return {\n              ...err,\n              customNotificationToShow: err.customNotificationToShow\n                ? err.customNotificationToShow.type === \"INTERNAL_SERVER_ERROR\"\n                  ? { ...err.customNotificationToShow, keepOpen: true }\n                  : err.customNotificationToShow\n                : undefined\n            };\n          })\n        );\n        return false;\n      },\n      loadedData => {\n        breakdanceUndo.ignore(() => {\n          globalStore.setSelectors(loadedData);\n          globalStore.markCurrentSelectorsAsUntouched();\n        });\n        return true;\n      }\n    )\n  );\n}\n\nexport async function saveSelectorsToWordPress(): Promise<boolean> {\n  return pipe(\n    await makeWordPressAjaxRequest({\n      friendlyName: \"Saving selectors to WordPress\",\n      action: \"breakdance_save_selectors\",\n      dataToPost: {\n        selectors: fpJsonStringify(globalStore.cssSelectors)\n      },\n      decoder: t.unknown\n    }),\n    fold(\n      (errors: _Error[]) => {\n        logErrorsToUiStore(errors);\n        return false;\n      },\n      () => {\n        breakdanceUndo.ignore(() =>\n          globalStore.markCurrentSelectorsAsUntouched()\n        );\n        return true;\n      }\n    )\n  );\n}\n","import { makeWordPressAjaxRequest } from \"@/lib/wordpress/ajax\";\nimport {\n  ConfigDataLoadedFromWordPress,\n  DocumentDataLoadedFromWordPress,\n  ExpectedDataToLoadConfig,\n  ExpectedDataToLoadConfigV,\n  ExpectedDataToLoadDocument,\n  ExpectedDataToLoadDocumentV\n} from \"@/types/load\";\nimport {\n  configStore,\n  documentStore,\n  uiStore,\n  globalStore,\n  browseModeStore\n} from \"@/store/store\";\nimport { initAPI } from \"@/lib/api/api\";\nimport defensiveCopy from \"@/util/defensive-copy\";\nimport { breakdanceUndo } from \"@/lib/undo/undo\";\nimport { Either, fold } from \"fp-ts/lib/Either\";\nimport { pipe } from \"fp-ts/lib/function\";\nimport { _Error, logErrorsToUiStore } from \"@/lib/wordpress/data\";\nimport { loadAllDynamicDataFromTreeIntoStore } from \"@/lib/dynamic-data/load\";\nimport { Store } from \"vuex\";\nimport {\n  precompileTemplatesOfElements,\n  precompileTwigMacrosTemplate\n} from \"@/lib/twig/twig\";\nimport {\n  getBuilderCanvasDocument,\n  setWindowBreakdanceObjectAssetsFunctionsForBuilderMode\n} from \"@/lib/canvas/helpers\";\nimport * as t from \"io-ts\";\nimport { TemplatePreviewableItem } from \"@/types/templates\";\nimport { fpJsonStringify } from \"@/util/fp-json-stringify\";\nimport { enableBrowseMode } from \"@/lib/browse-mode\";\nimport { BreakdanceWindowObjectDataFromLoaderForBrowseMode } from \"@/types/breakdance-window-object\";\nimport { BuilderElementV } from \"@/types/elements\";\nimport NotificationLogger from \"@/lib/notifications/notifications\";\nimport { chunk } from \"lodash\";\nimport { breakdanceStoreActions } from \"@/store/actions/store-actions\";\nimport { handlePresetsChanged } from \"@/lib/canvas/reacting-to-global-store-changes\";\nimport { TreeNode } from \"@/types/tree\";\n\nexport async function loadDocumentFromWordPress(\n  id: number\n): Promise<Either<_Error[], ExpectedDataToLoadDocument>> {\n  return await makeWordPressAjaxRequest({\n    action: \"breakdance_load_document\",\n    dataToPost: { id: id },\n    decoder: ExpectedDataToLoadDocumentV\n  });\n}\n\nexport async function loadConfigFromWordPress(): Promise<\n  Either<_Error[], ExpectedDataToLoadConfig>\n> {\n  return await makeWordPressAjaxRequest({\n    action: \"breakdance_load_document\",\n    decoder: ExpectedDataToLoadConfigV\n  });\n}\n\n/**\n * Initial mode is browse mode, loads config from WordPress\n */\nexport function initializeAppWhenInitialModeIsBrowse(\n  maybeLoadedData: Either<_Error[], ExpectedDataToLoadConfig>,\n  browseModeOptions?: Pick<\n    BreakdanceWindowObjectDataFromLoaderForBrowseMode,\n    \"browseModeOpenUrl\" | \"returnUrl\"\n  >\n) {\n  pipe(\n    maybeLoadedData,\n    fold(\n      errors => {\n        uiStore.setInterfaceState(\"normal\");\n\n        logErrorsToUiStore(\n          errors.map(err => {\n            return {\n              ...err,\n              customNotificationToShow: err.customNotificationToShow\n                ? err.customNotificationToShow.type === \"INTERNAL_SERVER_ERROR\"\n                  ? { ...err.customNotificationToShow, keepOpen: true }\n                  : err.customNotificationToShow\n                : undefined\n            };\n          })\n        );\n      },\n      async loadedData => {\n        initializeBreakdanceWindowObject();\n        initAPI(loadedData.plugins);\n\n        putDataInStoreFromWordPressConfig(loadedData);\n\n        if (browseModeOptions?.returnUrl) {\n          browseModeStore.setBackToAdminUrl(browseModeOptions.returnUrl);\n        }\n\n        precompileTwigMacrosTemplate();\n        precompileTemplatesOfElements();\n\n        uiStore.selectBaseBreakpoint();\n\n        enableBrowseMode(\n          \"globalSettings\",\n          browseModeOptions?.browseModeOpenUrl\n        );\n      }\n    )\n  );\n}\n\n/**\n * Initial mode is builder, loads both document data and config from WordPress\n */\nexport function initializeAppWhenInitialModeIsBuilder(\n  maybeLoadedData: Either<_Error[], ExpectedDataToLoadDocument>\n) {\n  pipe(\n    maybeLoadedData,\n    fold(\n      errors => {\n        uiStore.setInterfaceState(\"normal\");\n\n        logErrorsToUiStore(\n          errors.map(err => {\n            return {\n              ...err,\n              customNotificationToShow: err.customNotificationToShow\n                ? err.customNotificationToShow.type === \"INTERNAL_SERVER_ERROR\"\n                  ? { ...err.customNotificationToShow, keepOpen: true }\n                  : err.customNotificationToShow\n                : undefined\n            };\n          })\n        );\n      },\n      async loadedData => {\n        if (\"errorType\" in loadedData) {\n          uiStore.setInterfaceState(\"normal\");\n          configStore.setInvalidPostData(loadedData);\n\n          return;\n        }\n\n        initializeBreakdanceWindowObject();\n        setWindowBreakdanceObjectAssetsFunctionsForBuilderMode();\n\n        initAPI(loadedData.plugins);\n\n        putDataInStoreFromDocumentLoadedFromWordpress(loadedData);\n\n        precompileTwigMacrosTemplate();\n        precompileTemplatesOfElements();\n\n        await loadAllDynamicDataFromTreeIntoStore();\n\n        uiStore.selectBaseBreakpoint();\n        uiStore.setInterfaceState(\"normal\");\n\n        breakdanceUndo.initialize();\n      }\n    )\n  );\n}\n\nexport function putDataInStoreFromWordPressConfig(\n  d: ConfigDataLoadedFromWordPress\n) {\n  configStore.setEnvironment(d.environment);\n  configStore.setElementsAndAppendRootElement(d.builderElements);\n  configStore.setElementsExternalAttrsDepsAndActions(\n    d.elementsExternalAttrsDepsAndActions\n  );\n  configStore.setElementCategories(d.builderElementCategories);\n  configStore.setPreferences(d.preferences);\n  configStore.setDynamicFields(d.dynamicFields);\n  configStore.setConditions(d.conditions);\n  configStore.setFonts(d.fonts);\n  configStore.setGlobalSettingsControlsAndTemplate(\n    d.globalSettingsControlsAndTemplate\n  );\n  configStore.setAvailableDocuments(d.availableDocuments);\n  configStore.setAvailableMediaSizes(d.availableMediaSizes);\n  configStore.setAvailablePermissions(d.availablePermissions);\n  configStore.setPermission(d.permission);\n  configStore.setSelectorControls(d.selectors.controls);\n  configStore.setClassTemplate(d.selectors.template);\n  configStore.setNeededUrls(d.neededData);\n  configStore.setPresetsForElements(d.elementPresets);\n  configStore.setBuiltinBreakpoints(d.builtinBreakpoints);\n  configStore.setTwigMacros(d.twigMacros);\n  configStore.setTwigMacrosHash(d.twigMacrosHash);\n  configStore.setAvailableWordpressPlugins(d.availableWordpressPlugins);\n  configStore.setDesignLibrary(d.designLibrary);\n  configStore.setSubscriptionMode(d.subscriptionMode);\n  configStore.setExperiments(d.experiments);\n  configStore.setAi(d.ai);\n\n  breakdanceUndo.ignore(() => {\n    globalStore.setGlobalSettings(d.globalSettings);\n    globalStore.markCurrentGlobalSettingsAsUntouched();\n\n    globalStore.setSelectors(d.selectors.selectors);\n    globalStore.markCurrentSelectorsAsUntouched();\n\n    globalStore.setPresets(d.elementPresets);\n    globalStore.markCurrentPresetsAsUntouched();\n  });\n}\n\nexport function putDataInStoreFromDocumentLoadedFromWordpress(\n  d: DocumentDataLoadedFromWordPress\n) {\n  documentStore.setDocument(d.document);\n\n  configStore.setDocumentSpecificNeededUrls(d.documentSpecificNeededUrls);\n  configStore.loadTemplatePreviewData(d.templatePreview);\n\n  putDataInStoreFromWordPressConfig(d);\n}\n\nfunction initializeBreakdanceWindowObject() {\n  // Save the URL on first page load. The URL may change later and we want to be able to use it\n  // For example if we by using a Router\n  window.Breakdance.originalUrl = location.href;\n\n  window.Breakdance.stores = {\n    configStore,\n    documentStore,\n    uiStore,\n    globalStore\n  };\n}\n\nexport function getDocumentUrlFromId(documentId: number) {\n  const updatedUrl = new URL(window.Breakdance.originalUrl);\n\n  updatedUrl.searchParams.set(\"id\", `${documentId}`);\n  updatedUrl.search = updatedUrl.searchParams.toString();\n\n  return updatedUrl.href;\n}\n\nexport async function saveLastPreviewedItemInWp(\n  reviewableItem: TemplatePreviewableItem\n) {\n  return makeWordPressAjaxRequest({\n    action: \"breakdance_save_template_last_previewed_item\",\n    decoder: t.type({ success: t.literal(true) }),\n    dataToPost: {\n      postId: documentStore.document.documentMeta.id,\n      item: fpJsonStringify(reviewableItem)\n    }\n  });\n}\n\nclass InitialStoreState {\n  initialState: unknown;\n  store!: Store<any>;\n\n  setupHook(store: Store<any>) {\n    this.store = store;\n    this.initialState = defensiveCopy(this.store.state);\n  }\n\n  resetToInitialState() {\n    // TODO: but what about the AJX errors? lmfao.\n    const newState = defensiveCopy(this.initialState);\n    this.store.replaceState(newState);\n  }\n}\n\nexport const initialStoreState = new InitialStoreState();\n\nexport const vuexInitialStoreStateInitFunction = (store: Store<any>) => {\n  initialStoreState.setupHook(store);\n};\n\nexport async function loadBuilderElementsFromWordPress() {\n  pipe(\n    await makeWordPressAjaxRequest({\n      action: \"breakdance_load_builder_elements\",\n      resultKey: \"elements\",\n      decoder: t.array(BuilderElementV)\n    }),\n    fold(\n      errors => {\n        errors.forEach(e => NotificationLogger.log.message(e.msg));\n        configStore.setElementsLoadingState(\"failed\");\n        uiStore.logError(\"Failed to load elements\");\n      },\n      elements => {\n        const chunked = chunk(elements, 10);\n\n        chunked.forEach((elementsChunk, index) => {\n          // @ts-ignore\n          requestIdleCallback(() => {\n            configStore.addNonExistentElementsNonReactively(elementsChunk);\n            precompileTemplatesOfElements(elementsChunk);\n\n            const isLastChunk = index === chunked.length - 1;\n            if (isLastChunk) {\n              // TODO this clears and re-registers store actions for elements that have been initially loaded, should it only affect newly loaded elements?\n              breakdanceStoreActions.registerAllStoreActions();\n              configStore.setElementsLoadingState(\"success\");\n              handlePresetsChanged(getBuilderCanvasDocument());\n            }\n          });\n        });\n      }\n    )\n  );\n}\n\nexport async function replaceDocumentWithAnother(newDocumentId: number) {\n  const hasUnsavedChanges = uiStore.unsavedChangesPresent;\n\n  // Unsaved changes check\n  if (hasUnsavedChanges) {\n    const confirmed = window.confirm(\n      \"You have unsaved changes, are you sure you want to leave?\"\n    );\n\n    if (!confirmed) return;\n  }\n\n  // Cleanup event listeners for all tree nodes\n  const nodes = documentStore.document.tree._lookupTable as Record<\n    number,\n    TreeNode\n  >;\n  const allElementIds = Object.keys(nodes).map(Number);\n\n  allElementIds.forEach(id =>\n    breakdanceStoreActions.run.onBeforeDeletingElement({ elementId: id })\n  );\n\n  // Reset internal callbacks map.\n  breakdanceStoreActions.resetAllCallbacks();\n\n  uiStore.setCanvasState(\"loading\");\n  configStore.setLeavingIframeOnPurpose(true);\n\n  // Keep a copy of the elements to be able to restore them later.\n  const elements = configStore.elements;\n\n  // Load the new document.\n  const maybeLoadedData = await loadDocumentFromWordPress(newDocumentId);\n\n  initializeAppWhenInitialModeIsBuilder(maybeLoadedData);\n\n  uiStore.setUnsavedChangesPresent(false);\n  configStore.setElementsMutation(elements);\n\n  // Update Post ID in the query param.\n  // @ts-ignore\n  const currentUrl = new URL(window.location);\n\n  currentUrl.searchParams.set(\"id\", `${newDocumentId}`);\n\n  // Update the URL without reloading the page\n  // @ts-ignore\n  window.history.replaceState({}, \"\", currentUrl);\n}\n","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('v-app',{staticClass:\"breakdance-admin-wp\"},[_c('Notifications'),_c('div',{staticClass:\"manage-templates-app\"},[(_vm.isBlockPostType)?[_c('ManageGlobalBlocks')]:[_c('ManageTemplates',{attrs:{\"postType\":_vm.postType}})]],2)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',[(_vm.isLoadingData)?_c('Loading'):_vm._e(),_c('div',{staticClass:\"manage-templates\"},[_c('div',{staticClass:\"manage-templates__header\"},[_c('h1',{staticClass:\"manage-templates__title\"},[_vm._v(\" \"+_vm._s(_vm.showTrash ? `Deleted ${_vm.templateName}s` : `${_vm.templateName}s`)+\" \")]),(!_vm.showTrash)?[(\n            _vm.postType === 'breakdance_header' ||\n            _vm.postType === 'breakdance_footer' ||\n            _vm.postType === 'breakdance_popup'\n          )?_c('v-btn',{staticClass:\"breakdance-wp-admin-templating-button\",attrs:{\"elevation\":\"0\",\"outlined\":\"\"},on:{\"click\":function($event){_vm.modalData = { type: 'add', data: _vm.blankTemplateWithValidSettings }}}},[(_vm.postType === 'breakdance_header')?_c('span',[_vm._v(\"Add Header\")]):_vm._e(),(_vm.postType === 'breakdance_footer')?_c('span',[_vm._v(\"Add Footer\")]):_vm._e(),(_vm.postType === 'breakdance_popup')?_c('span',[_vm._v(\"Add Popup\")]):_vm._e()]):_vm._e(),(_vm.postType === 'breakdance_template')?_c('AddTemplateDropdown',{attrs:{\"templateName\":_vm.templateName,\"isWooCommerceActive\":_vm.isWooCommerceActive,\"templates\":_vm.templatesByStatus},on:{\"input\":_vm.saveTemplate,\"blankModal\":function($event){return _vm.handleTemplateCardModal(`add`, _vm.blankTemplateWithValidSettings)},\"modalWithSettings\":function($event){return _vm.handleTemplateCardModal(`add`, $event)}}}):_vm._e()]:_vm._e()],2),(\n        this.templatesByStatus.length > 0 ||\n        this.filteredTemplatesBySearch.length > 0 ||\n        _vm.trashLength > 0 ||\n        _vm.showTrash\n      )?_c('div',{staticClass:\"manage-templates__actions\"},[(!_vm.showTrash)?_c('div',{staticClass:\"manage-templates__search\"},[_c('SearchInput',{attrs:{\"placeholder\":_vm.searchInputPlaceholder},model:{value:(_vm.search),callback:function ($$v) {_vm.search=$$v},expression:\"search\"}})],1):_vm._e(),_c('div',{staticClass:\"manage-templates__secondary-actions\"},[(_vm.showTrash && this.templatesByStatus.length)?_c('v-btn',{staticClass:\"mr-4\",attrs:{\"text\":\"\",\"loading\":_vm.emptyingTrash},on:{\"click\":_vm.emptyTrash}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"TrashIcon\",\"size\":\"16\"}}),_vm._v(\" Empty Trash \")],1):_vm._e(),(_vm.trashLength || _vm.showTrash)?_c('v-btn',{attrs:{\"text\":\"\"},on:{\"click\":function($event){_vm.showTrash = !_vm.showTrash}}},[(_vm.showTrash)?[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"ArrowLeftLongIcon\",\"size\":\"16\"}}),_vm._v(\" Back \")]:[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"TrashIcon\",\"size\":\"16\"}}),_vm._v(\" Trash (\"+_vm._s(_vm.trashLength)+\") \")]],2):_vm._e()],1)]):_vm._e()]),_c('EmptyState',{attrs:{\"value\":_vm.emptyStateData}}),(_vm.filteredTemplatesBySearch.length > 0)?_c('v-simple-table',{staticClass:\"manage-templates__table breakdance-table\",class:_vm.newTemplateAdded ? 'added' : ''},[_c('thead',[_c('tr',[_c('th',{attrs:{\"width\":\"35%\"}},[_vm._v(\"Template\")]),_c('th',{attrs:{\"width\":\"25%\"}},[_vm._v(\"Applies to\")]),_c('th',{attrs:{\"width\":\"15%\"}},[_vm._v(\"Conditions\")]),(_vm.postType === 'breakdance_popup')?_c('th',{attrs:{\"width\":\"15%\"}},[_vm._v(\"Triggers\")]):_vm._e(),(_vm.postType !== 'breakdance_popup')?_c('th',{attrs:{\"width\":\"15%\"}},[_vm._v(\"Priority\")]):_vm._e(),_c('th',{attrs:{\"width\":\"10%\"}},[_vm._v(\"Active\")])])]),_c('transition-group',{attrs:{\"tag\":\"tbody\",\"name\":\"fade\",\"mode\":\"in-out\"}},_vm._l((_vm.filteredTemplatesBySearch),function(template){return _c('TemplateRow',{key:template.id,class:!_vm.newTemplateAdded ? 'animation-disabled' : '',attrs:{\"value\":_vm.getTemplateWithValidSettings(template),\"templateTypeCategories\":_vm.templatesManagementData.templateTypeCategories,\"templateParents\":_vm.templateParentsWithoutTrashed},on:{\"input\":_vm.handleTemplateCardModal,\"update\":_vm.updateTemplate,\"duplicate\":_vm.duplicateTemplate,\"trash\":_vm.trashTemplate,\"delete\":_vm.deleteTemplate,\"restore\":_vm.restoreTemplate}})}),1)],1):_vm._e(),(_vm.modalData)?_c('EditTemplateModal',{attrs:{\"value\":_vm.modalData.data,\"templatesManagementData\":_vm.templatesManagementData,\"postType\":_vm.postType,\"templateParents\":_vm.templateParentsWithoutTrashed,\"templates\":_vm.templatesByStatus,\"mode\":_vm.modalData.type,\"skipWarning\":_vm.skipWarning,\"hasPermissionToManageFallbacks\":_vm.hasPermissionToManageFallbacks},on:{\"input\":function($event){return _vm.saveTemplate($event)},\"close\":function($event){_vm.modalData = false},\"skipWarning\":function($event){_vm.skipWarning = $event}}}):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('tr',[_c('td',[_c('div',{staticClass:\"manage-templates__title-row\"},[(_vm.mode === 'trash')?_c('span',{staticClass:\"manage-templates__title-link\"},[_vm._v(\" \"+_vm._s(_vm.value.title)+\" \"),_c('span',{staticClass:\"manage-templates__title-id\"},[_vm._v(\"#\"+_vm._s(_vm.value.id))])]):_c('a',{staticClass:\"manage-templates__title-link\",attrs:{\"target\":\"_top\",\"href\":_vm.value.editInBreakdanceLink}},[_vm._v(\" \"+_vm._s(_vm.value.title)+\" \"),_c('span',{staticClass:\"manage-templates__title-id\"},[_vm._v(\"#\"+_vm._s(_vm.value.id))])])]),_c('div',{staticClass:\"manage-templates__row-actions\"},[(_vm.mode === 'publish')?_c('a',{staticClass:\"manage-templates__btn-action\",attrs:{\"href\":_vm.value.editInBreakdanceLink,\"target\":\"_top\",\"title\":\"Edit in Breakdance\"}},[_vm._v(\" Edit in Breakdance \")]):_vm._e(),(_vm.mode === 'publish')?_c('button',{staticClass:\"manage-templates__btn-action\",attrs:{\"title\":\"Settings\"},on:{\"click\":_vm.openEditTemplateModal}},[_vm._v(\" Settings \")]):_vm._e(),(_vm.mode === 'trash')?_c('button',{staticClass:\"manage-templates__btn-action\",attrs:{\"title\":\"Restore\"},on:{\"click\":_vm.restoreTemplate}},[_vm._v(\" Restore \")]):_vm._e(),(_vm.mode === 'publish')?_c('button',{staticClass:\"manage-templates__btn-action\",attrs:{\"title\":\"Duplicate\"},on:{\"click\":_vm.duplicateTemplate}},[_vm._v(\" Duplicate \")]):_vm._e(),_c('button',{staticClass:\"manage-templates__btn-action is-danger\",attrs:{\"title\":_vm.mode === 'publish' ? 'Trash' : 'Delete permanently'},on:{\"click\":_vm.deleteTemplate}},[_vm._v(\" \"+_vm._s(_vm.mode === \"publish\" ? \"Trash\" : \"Delete permanently\")+\" \")])])]),_c('td',{staticClass:\"manage-template__applies-to\"},[(_vm.matchingQuickAddTemplate)?[_c('span',{staticClass:\"d-block\"},[_vm._v(_vm._s(_vm.matchingQuickAddTemplate.name))]),_c('ElementBadge',{staticClass:\"template-row-element-badge\",attrs:{\"value\":{\n          backgroundColor: _vm.matchingQuickAddTemplate.backgroundColor,\n          textColor: _vm.matchingQuickAddTemplate.textColor,\n          label: _vm.matchingQuickAddTemplate.category\n        }}})]:(_vm.appliesToLabel)?[_vm._v(_vm._s(_vm.appliesToLabel))]:_vm._e()],2),_c('td',[(_vm.value.settings.ruleGroups && _vm.value.settings.ruleGroups.length)?[_c('ConditionsPreviewTooltip',{attrs:{\"value\":_vm.value.settings.ruleGroups}})]:_vm._e()],2),(_vm.value.postType === 'breakdance_popup')?_c('td',{staticClass:\"manage-template__td_text\"},[_vm._v(\" \"+_vm._s(_vm.triggerLabels(_vm.value.settings.triggers))+\" \")]):_vm._e(),(_vm.value.postType !== 'breakdance_popup')?_c('td',{staticClass:\"manage-template__td_text\"},[(_vm.value.settings.priority !== undefined)?[_vm._v(\" \"+_vm._s(_vm.value.settings.priority)+\" \")]:_vm._e()],2):_vm._e(),_c('td',{staticClass:\"manage-template__td_text\"},[[_c('ToggleInput',{attrs:{\"value\":!_vm.value.settings.disabled},on:{\"input\":_vm.updateDisabled}})]],2)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',[[_c('v-tooltip',{staticClass:\"condition-preview-tooltip-element\",attrs:{\"bottom\":\"\",\"transition\":\"0\"},scopedSlots:_vm._u([{key:\"activator\",fn:function({ on, attrs }){return [_c('span',_vm._g(_vm._b({},'span',attrs,false),on),[_c('Icon',{attrs:{\"icon\":\"CodeBranchIcon\",\"size\":\"18\"}})],1)]}}])},[_c('span',[_c('div',{staticClass:\"condition-preview-tooltip-contanier\"},[_vm._l((_vm.value),function(group,index){return [_c('div',{staticClass:\"condition-preview-tooltip\"},[(index > 0)?_c('span',{staticClass:\"condition-preview-or-separator\"},[_c('span',[_vm._v(\"OR\")])]):_vm._e(),_vm._l((group),function(rule,ruleIndex){return _c('ConditionPreviewRule',{key:ruleIndex,attrs:{\"rule\":rule,\"index\":ruleIndex}})})],2)]})],2)])])]],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport Vue from \"vue\";\nimport { Component, Prop } from \"vue-property-decorator\";\nimport defensiveCopy from \"@/util/defensive-copy\";\nimport { RuleGroup } from \"@/types/conditions\";\nimport ConditionPreviewRule from \"@/components/Reusable/CustomInputs/ConditionInput/ConditionPreviewRule.vue\";\nimport Icon from \"@/components/UI/Icon.vue\";\n\n@Component({\n  components: { ConditionPreviewRule, Icon }\n})\nexport default class ConditionsPreview extends Vue {\n  @Prop()\n  value!: RuleGroup[] | undefined;\n\n  edit(value: unknown) {\n    this.$emit(\"input\", defensiveCopy(value));\n  }\n}\n","import mod from \"-!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ConditionPreviewTooltip.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ConditionPreviewTooltip.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ConditionPreviewTooltip.vue?vue&type=template&id=70a29c4c&\"\nimport script from \"./ConditionPreviewTooltip.vue?vue&type=script&lang=ts&\"\nexport * from \"./ConditionPreviewTooltip.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ConditionPreviewTooltip.vue?vue&type=style&index=0&id=70a29c4c&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { QuickAddTemplate } from \"@/subapps/manage-templates/types\";\nimport color from \"@/sass/modules/color.module.scss\";\n\nexport const QUICK_ADD_TEMPLATES: QuickAddTemplate[] = [\n  {\n    name: \"Single Product\",\n    category: \"Woo\",\n    textColor: \"var(--brandWooCommerce)\",\n    backgroundColor: \"var(--brandWooCommerceBackground)\",\n    settings: {\n      type: \"product\",\n      ruleGroups: [],\n      priority: 20\n    }\n  },\n  {\n    name: \"Shop Page & All Product Archives\",\n    category: \"Woo\",\n    textColor: \"var(--brandWooCommerce)\",\n    backgroundColor: \"var(--brandWooCommerceBackground)\",\n    settings: {\n      type: \"all-product-archives\",\n      ruleGroups: [],\n      priority: 10\n    }\n  },\n  {\n    name: \"Specific Product Archive\",\n    category: \"Woo\",\n    textColor: \"var(--brandWooCommerce)\",\n    backgroundColor: \"var(--brandWooCommerceBackground)\",\n    settings: {\n      type: \"specific-product-archive\",\n      ruleGroups: [\n        [\n          {\n            ruleSlug: \"product-is-taxonomy\",\n            operand: \"is\",\n            value: []\n          }\n        ]\n      ],\n      priority: 20\n    },\n    openDialog: true\n  },\n  {\n    name: \"Single Post\",\n    category: \"Blog\",\n    textColor: \"var(--brandWordPress)\",\n    backgroundColor: \"var(--brandWordPressBackground)\",\n    settings: {\n      type: \"post\",\n      ruleGroups: [],\n      priority: 20\n    }\n  },\n  {\n    name: \"Post Archive\",\n    category: \"Blog\",\n    textColor: \"var(--brandWordPress)\",\n    backgroundColor: \"var(--brandWordPressBackground)\",\n    settings: {\n      type: \"post-archives\",\n      ruleGroups: [],\n      priority: 10\n    }\n  },\n  {\n    name: \"404 Not Found\",\n    category: \"Other\",\n    textColor: color.green800_light,\n    backgroundColor: color.green100_light,\n    settings: {\n      type: \"404\",\n      ruleGroups: []\n    }\n  },\n  {\n    name: \"Search Results\",\n    textColor: color.green800_light,\n    backgroundColor: color.green100_light,\n    category: \"Other\",\n    settings: {\n      type: \"search\",\n      ruleGroups: []\n    }\n  }\n];\n","\nimport Vue from \"vue\";\nimport { Component, Prop } from \"vue-property-decorator\";\nimport {\n  TemplateParents,\n  TemplateTypeCategories,\n  TemplateWithValidSettings\n} from \"./types\";\nimport ConditionsPreviewTooltip from \"@/components/Reusable/CustomInputs/ConditionInput/ConditionPreviewTooltip.vue\";\nimport {\n  deleteTemplateFromWordPress,\n  restoreTemplateFromWordPress\n} from \"./lib/api\";\nimport Icon from \"@/components/UI/Icon.vue\";\nimport { QUICK_ADD_TEMPLATES } from \"@/subapps/manage-templates/lib/quick-add-templates\";\nimport ElementBadge from \"@/components/ElementPropertiesPanel/ElementBadge.vue\";\nimport { Trigger } from \"@/types/conditions\";\nimport ToggleInput from \"@/components/Reusable/CustomInputs/ToggleInput.vue\";\nimport defensiveCopy from \"@/util/defensive-copy\";\n\n@Component({\n  components: {\n    ToggleInput,\n    Icon,\n    ConditionsPreviewTooltip,\n    ElementBadge\n  }\n})\nexport default class TemplateRow extends Vue {\n  @Prop()\n  value!: TemplateWithValidSettings;\n\n  @Prop()\n  templateTypeCategories!: TemplateTypeCategories;\n\n  @Prop()\n  templateParents!: TemplateParents;\n\n  openEditTemplateModal() {\n    if (this.mode === \"trash\") {\n      return;\n    }\n\n    this.$emit(\"input\", \"edit\", this.value);\n  }\n\n  get mode() {\n    return this.value.status;\n  }\n\n  get appliesToLabel() {\n    const templateType = this.value.settings.type;\n    let templateTypeLabel = \"\";\n\n    this.templateTypeCategories.some(templateTypeCategory => {\n      const currentTemplateType = templateTypeCategory.types.find(\n        type => type.slug === templateType\n      );\n\n      if (currentTemplateType) {\n        templateTypeLabel = currentTemplateType.label;\n\n        return true;\n      }\n\n      return false;\n    });\n\n    return templateTypeLabel;\n  }\n\n  deleteInProgress = false;\n\n  async deleteTemplate() {\n    this.deleteInProgress = true;\n\n    const response = await deleteTemplateFromWordPress(\n      this.value.title,\n      this.value.id,\n      this.value.status\n    );\n\n    if (response) {\n      this.$emit(\n        this.value.status === \"publish\" ? \"trash\" : \"delete\",\n        response\n      );\n    }\n\n    this.deleteInProgress = false;\n  }\n\n  restoreInProgress = false;\n\n  async restoreTemplate() {\n    this.restoreInProgress = true;\n\n    const response = await restoreTemplateFromWordPress(\n      this.value.title,\n      this.value.id\n    );\n\n    if (response) this.$emit(\"restore\", response);\n\n    this.restoreInProgress = false;\n  }\n\n  duplicateTemplate() {\n    const duplicatedTemplate = defensiveCopy(this.value);\n\n    duplicatedTemplate.title = `Copy of \"${duplicatedTemplate.title}\"`;\n    duplicatedTemplate.settings.disabled = true;\n\n    this.$emit(\"duplicate\", duplicatedTemplate);\n  }\n\n  get matchingQuickAddTemplate() {\n    return QUICK_ADD_TEMPLATES.find(\n      quickAddTemplate =>\n        quickAddTemplate.settings.type === this.value.settings.type\n    );\n  }\n\n  triggerLabels(triggers: Trigger[]) {\n    return triggers\n      .map(trigger => {\n        return trigger.slug;\n      })\n      .join(\", \");\n  }\n\n  updateDisabled(enabled: boolean) {\n    const newTemplate = defensiveCopy(this.value);\n\n    newTemplate.settings.disabled = !enabled;\n\n    this.$emit(\"update\", newTemplate);\n  }\n}\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./TemplateRow.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./TemplateRow.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TemplateRow.vue?vue&type=template&id=3d230cfe&\"\nimport script from \"./TemplateRow.vue?vue&type=script&lang=ts&\"\nexport * from \"./TemplateRow.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./TemplateRow.vue?vue&type=style&index=0&id=3d230cfe&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',[_c('Dropdown',{attrs:{\"offset-y\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function({ on }){return [_c('v-btn',_vm._g({staticClass:\"breakdance-wp-admin-templating-button\",attrs:{\"elevation\":\"0\",\"outlined\":\"\",\"loading\":_vm.quickAddInProgress}},on),[_vm._v(\" Add Template \")])]}}]),model:{value:(_vm.open),callback:function ($$v) {_vm.open=$$v},expression:\"open\"}},[_c('v-card',[_c('v-list',{attrs:{\"dense\":\"\",\"width\":\"350\"}},[_vm._l((_vm.quickAddTemplates),function(quickAddTemplate){return _c('v-list-item',{key:quickAddTemplate.name,on:{\"click\":function($event){return _vm.quickAdd(quickAddTemplate)}}},[_c('v-list-item-title',{staticClass:\"quick-add-item\"},[_vm._v(\" \"+_vm._s(quickAddTemplate.name)+\" \"),_c('ElementBadge',{attrs:{\"value\":{\n                backgroundColor: quickAddTemplate.backgroundColor,\n                textColor: quickAddTemplate.textColor,\n                label: quickAddTemplate.category\n              }}})],1)],1)}),_c('v-list-item',{staticClass:\"add-custom-template-wrapper\"},[_c('v-list-item-title',{staticClass:\"add-custom-template-wrapper-title\"},[_c('v-btn',{staticClass:\"breakdance-wp-admin-templating-button\",attrs:{\"outlined\":\"\"},on:{\"click\":function($event){return _vm.$emit('blankModal')}}},[_vm._v(\"Add Custom Template\")])],1)],1)],2)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport Vue from \"vue\";\nimport { Component, Prop } from \"vue-property-decorator\";\nimport Dropdown from \"@/components/Reusable/Dropdown/Dropdown.vue\";\nimport { QuickAddTemplate, Template, TemplateWithValidSettings } from \"./types\";\nimport { saveTemplateToWordPress } from \"./lib/api\";\nimport { pipe } from \"fp-ts/lib/function\";\nimport { fold } from \"fp-ts/lib/Either\";\nimport NotificationLogger from \"@/lib/notifications/notifications\";\nimport { QUICK_ADD_TEMPLATES } from \"@/subapps/manage-templates/lib/quick-add-templates\";\nimport { checkIfTemplateSettingsAlreadyExistsAndConfirmToContinue } from \"@/subapps/manage-templates/lib/utils\";\nimport ElementBadge from \"@/components/ElementPropertiesPanel/ElementBadge.vue\";\n\n@Component({\n  components: { Dropdown, ElementBadge }\n})\nexport default class AddTemplateDropdown extends Vue {\n  @Prop()\n  templateName!: string;\n\n  @Prop()\n  isWooCommerceActive!: boolean;\n\n  @Prop()\n  templates!: Template[];\n\n  open = false;\n  quickAddInProgress = false;\n\n  get quickAddTemplates() {\n    return this.isWooCommerceActive\n      ? QUICK_ADD_TEMPLATES\n      : QUICK_ADD_TEMPLATES.filter(\n          template => template.category.toLowerCase() !== \"woocommerce\"\n        );\n  }\n\n  async quickAdd(quickAddTemplate: QuickAddTemplate) {\n    const templateToAdd: TemplateWithValidSettings = {\n      // -1 = new post in wp\n      id: -1,\n      title: quickAddTemplate.name,\n      editInBreakdanceLink: \"\",\n      postType: \"breakdance_template\",\n      settings: quickAddTemplate.settings,\n      status: \"publish\"\n    };\n\n    if (\n      !checkIfTemplateSettingsAlreadyExistsAndConfirmToContinue(\n        this.templates,\n        quickAddTemplate.settings,\n        \"template\"\n      )\n    ) {\n      return;\n    }\n\n    if (quickAddTemplate.openDialog) {\n      this.$emit(\"modalWithSettings\", templateToAdd);\n\n      return;\n    }\n\n    this.quickAddInProgress = true;\n\n    pipe(\n      await saveTemplateToWordPress(templateToAdd),\n      fold(\n        () => {\n          NotificationLogger.log.message(\n            `The new ${this.templateName} couldn't be saved`\n          );\n        },\n        savedTemplate => {\n          this.$emit(\"input\", savedTemplate);\n        }\n      )\n    );\n\n    this.quickAddInProgress = false;\n  }\n}\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AddTemplateDropdown.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AddTemplateDropdown.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./AddTemplateDropdown.vue?vue&type=template&id=545e61b8&\"\nimport script from \"./AddTemplateDropdown.vue?vue&type=script&lang=ts&\"\nexport * from \"./AddTemplateDropdown.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./AddTemplateDropdown.vue?vue&type=style&index=0&id=545e61b8&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return (_vm.value.itemsByStatus === 0 || _vm.value.filteredItemsBySearch === 0)?_c('div',{staticClass:\"manage-templates__empty\"},[(_vm.value.templateName == 'Header')?_c('svg',{staticClass:\"manage-templates__empty-state-icon\",attrs:{\"fill\":\"none\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 100 100\"}},[_c('path',{attrs:{\"d\":\"M92.708 3.125H7.292a4.167 4.167 0 0 0-4.167 4.167v85.416a4.167 4.167 0 0 0 4.167 4.167h85.416a4.167 4.167 0 0 0 4.167-4.167V7.292a4.167 4.167 0 0 0-4.167-4.167ZM3.125 34.375h93.75\",\"stroke\":\"currentColor\",\"stroke-width\":\"6.25\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}})]):_vm._e(),(_vm.value.templateName == 'Footer')?_c('svg',{staticClass:\"manage-templates__empty-state-icon\",attrs:{\"fill\":\"none\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 100 100\"}},[_c('path',{attrs:{\"d\":\"M92.708 3.125H7.292a4.167 4.167 0 0 0-4.167 4.167v85.416a4.167 4.167 0 0 0 4.167 4.167h85.416a4.167 4.167 0 0 0 4.167-4.167V7.292a4.167 4.167 0 0 0-4.167-4.167ZM96.875 65.625H3.125\",\"stroke\":\"currentColor\",\"stroke-width\":\"6.25\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}})]):_vm._e(),(\n      _vm.value.templateName == 'Template' ||\n      _vm.value.templateName == 'Unsupported template' ||\n      _vm.value.templateName == 'Global Block'\n    )?_c('svg',{staticClass:\"manage-templates__empty-state-icon\",attrs:{\"fill\":\"none\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 100 100\"}},[_c('path',{attrs:{\"d\":\"M92.708 3.125H7.292a4.167 4.167 0 0 0-4.167 4.167v85.416a4.167 4.167 0 0 0 4.167 4.167h85.416a4.167 4.167 0 0 0 4.167-4.167V7.292a4.167 4.167 0 0 0-4.167-4.167ZM50 3.125v93.75M50 34.375h46.875M96.875 65.625H50M50 50H3.125\",\"stroke\":\"currentColor\",\"stroke-width\":\"6.25\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}})]):(_vm.value.itemsByStatus === 0)?_c('div',[_c('h4',[_vm._v(\" You have no \"+_vm._s(_vm.value.showTrash ? \"deleted\" : \"published\")+\" \"+_vm._s(_vm.value.templateName.toLowerCase())+\"s. \")])]):(_vm.value.filteredItemsBySearch === 0)?_c('div',[_c('h4',[_vm._v(\"No \"+_vm._s(_vm.value.templateName.toLowerCase())+\"s found.\")])]):_vm._e()]):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport Vue from \"vue\";\nimport { Component, Prop } from \"vue-property-decorator\";\nimport { EmptyStateV } from \"./types\";\nimport { isBreakdanceDevelopmentEnvironment } from \"@/lib/dev/development-environment\";\n@Component({})\nexport default class EmptyState extends Vue {\n  @Prop()\n  value!: EmptyStateV;\n\n  get isBreakdanceDevelopmentEnvironment() {\n    return isBreakdanceDevelopmentEnvironment();\n  }\n}\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EmptyState.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EmptyState.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./EmptyState.vue?vue&type=template&id=66753c02&\"\nimport script from \"./EmptyState.vue?vue&type=script&lang=ts&\"\nexport * from \"./EmptyState.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\nimport \"@/sass/globals.scss\";\n\nimport Vue from \"vue\";\nimport { Component, Prop, Watch } from \"vue-property-decorator\";\nimport { pipe } from \"fp-ts/lib/function\";\nimport {\n  TemplatesManagementData,\n  SupportedPostType,\n  Template,\n  TemplateParents,\n  TemplateSettings,\n  TemplateSettingsV,\n  TemplateWithValidSettings,\n  EmptyStateV\n} from \"./types\";\nimport { fold } from \"fp-ts/lib/Either\";\n\nimport TemplateRow from \"./TemplateRow.vue\";\nimport AddTemplateDropdown from \"./AddTemplateDropdown.vue\";\nimport {\n  duplicateTemplateToWordPress,\n  emptyTrashForPostType,\n  getAllTemplatesAndNeededDataFromWordPress,\n  saveTemplateToWordPress\n} from \"./lib/api\";\nimport NotificationLogger from \"@/lib/notifications/notifications\";\nimport { configStore } from \"@/store/store-accessor\";\nimport EditTemplateModal from \"@/subapps/manage-templates/EditTemplateModal.vue\";\nimport Notifications from \"@/components/Notifications/Notifications.vue\";\nimport Loading from \"@/components/Reusable/Loading.vue\";\nimport {\n  changeTemplateStatus,\n  deleteAllTrash,\n  deleteTemplate,\n  saveNewTemplate\n} from \"@/subapps/manage-templates/lib/utils\";\nimport SearchInput from \"@/components/Reusable/CustomInputs/SearchInput.vue\";\nimport Icon from \"@/components/UI/Icon.vue\";\nimport EmptyState from \"@/subapps/manage-templates/EmptyState.vue\";\nimport { keyboardShortcuts } from \"@/lib/keyboard-shortcuts/keyboard-shortcuts\";\nimport { listenForNonceUpdates } from \"@/util/nonce-broadcast\";\n\n@Component({\n  components: {\n    Icon,\n    SearchInput,\n    Loading,\n    Notifications,\n    EditTemplateModal,\n    AddTemplateDropdown,\n    TemplateRow,\n    EmptyState\n  }\n})\nexport default class ManageBreakdancePostTypes extends Vue {\n  @Prop()\n  postType!: SupportedPostType;\n\n  modalData: { type: \"edit\" | \"add\"; data: Template } | false = false;\n\n  skipWarning = false;\n\n  templates: Template[] = [];\n  templatesManagementData: TemplatesManagementData = {\n    conditions: [],\n    dynamicFields: [],\n    templateTypeCategories: [],\n    popupTriggers: null\n  };\n\n  isWooCommerceActive = false;\n  search = \"\";\n  showTrash = false;\n\n  newTemplateAdded = false;\n\n  hasPermissionToManageFallbacks = false;\n\n  @Watch(\"newTemplateAdded\")\n  onTemplateAdded() {\n    setTimeout(() => (this.newTemplateAdded = false), 1000);\n  }\n\n  get templatesForUi() {\n    return this.hasPermissionToManageFallbacks\n      ? this.templatesByStatus\n      : this.templatesByStatus.filter(t => !t.settings?.fallback);\n  }\n\n  get filteredTemplatesBySearch() {\n    return this.search\n      ? this.templatesForUi.filter(template => {\n          return (\n            template.title.toLowerCase().includes(this.search.toLowerCase()) ||\n            template.settings?.type?.includes(this.search.toLowerCase())\n          );\n        })\n      : this.templatesForUi;\n  }\n\n  get templatesByStatus() {\n    return this.templates.filter(template =>\n      this.showTrash\n        ? template.status === \"trash\"\n        : template.status === \"publish\"\n    );\n  }\n\n  get blankTemplateWithValidSettings(): TemplateWithValidSettings {\n    return {\n      id: -1,\n      title: \"\",\n      postType: this.postType,\n      editInBreakdanceLink: \"\",\n      settings: {},\n      status: \"publish\"\n    };\n  }\n\n  get trashLength() {\n    return this.templates.filter(template => template.status === \"trash\")\n      .length;\n  }\n\n  async duplicateTemplate(newTemplateWithOldId: TemplateWithValidSettings) {\n    pipe(\n      await duplicateTemplateToWordPress(newTemplateWithOldId),\n      fold(\n        () => {\n          NotificationLogger.log.message(\n            `Duplicating template \"${newTemplateWithOldId.id}\" failed`\n          );\n        },\n        newTemplate => {\n          this.saveTemplate(newTemplate);\n        }\n      )\n    );\n  }\n\n  async updateTemplate(updatedTemplate: TemplateWithValidSettings) {\n    pipe(\n      await saveTemplateToWordPress(updatedTemplate),\n      fold(\n        () => {\n          NotificationLogger.log.message(\n            `Update for template \"${updatedTemplate.id}\" failed`\n          );\n        },\n        newTemplate => {\n          this.templates = saveNewTemplate(newTemplate, this.templates);\n        }\n      )\n    );\n  }\n\n  saveTemplate(newTemplate: Template) {\n    this.templates = saveNewTemplate(newTemplate, this.templates);\n\n    this.newTemplateAdded = true;\n  }\n\n  deleteTemplate(idToDelete: number) {\n    this.templates = deleteTemplate(idToDelete, this.templates);\n  }\n\n  trashTemplate(idToDelete: number) {\n    this.templates = changeTemplateStatus(idToDelete, this.templates, \"trash\");\n  }\n\n  restoreTemplate(idToRestore: number) {\n    this.templates = changeTemplateStatus(\n      idToRestore,\n      this.templates,\n      \"publish\"\n    );\n  }\n\n  emptyingTrash = false;\n  async emptyTrash() {\n    this.emptyingTrash = true;\n\n    if (await emptyTrashForPostType(this.postType)) {\n      this.templates = deleteAllTrash(this.templates);\n      this.showTrash = false;\n    }\n\n    this.emptyingTrash = false;\n  }\n\n  get templateParentsWithoutTrashed(): TemplateParents {\n    return this.templates\n      .filter(template => template.status !== \"trash\")\n      .map(template => ({\n        text: template.title,\n        value: template.id\n      }));\n  }\n\n  get templateName() {\n    if (this.postType === \"breakdance_template\") return \"Template\";\n    if (this.postType === \"breakdance_footer\") return \"Footer\";\n    if (this.postType === \"breakdance_header\") return \"Header\";\n    if (this.postType === \"breakdance_popup\") return \"Popup\";\n\n    return \"Unsupported template\";\n  }\n\n  get emptyStateData(): EmptyStateV {\n    return {\n      itemsByStatus: this.templatesByStatus.length,\n      filteredItemsBySearch: this.filteredTemplatesBySearch.length,\n      templateName: this.templateName,\n      showTrash: this.showTrash\n    };\n  }\n\n  get searchInputPlaceholder() {\n    const templateName = this.templateName.toLowerCase();\n    return `Search for ${templateName}s`;\n  }\n\n  isLoadingData = false;\n\n  broadcastChannel: BroadcastChannel | null = null;\n  beforeMount() {\n    this.broadcastChannel = listenForNonceUpdates();\n  }\n\n  async mounted() {\n    keyboardShortcuts.register(\"b r e a k d a n c e\", () => {\n      this.hasPermissionToManageFallbacks =\n        !this.hasPermissionToManageFallbacks;\n    });\n\n    this.isLoadingData = true;\n\n    pipe(\n      await getAllTemplatesAndNeededDataFromWordPress(this.postType),\n      fold(\n        () => {\n          NotificationLogger.log.message(\"Couldn't load templates data\");\n        },\n        data => {\n          this.templates = data.templates;\n          this.templatesManagementData = data.templatesManagementData;\n          this.isWooCommerceActive = data.isWooCommerceActive;\n          configStore.setDynamicFields(\n            data.templatesManagementData.dynamicFields\n          );\n          // Necessary for ConditionPreviewRule to display the condition's label instead of the rule slug\n          configStore.setConditions(data.templatesManagementData.conditions);\n          configStore.setEnvironment(data.environment);\n        }\n      )\n    );\n\n    this.isLoadingData = false;\n  }\n\n  beforeDestroy() {\n    keyboardShortcuts.unbind(\"b r e a k d a n c e\");\n    if (this.broadcastChannel) {\n      this.broadcastChannel.close();\n    }\n  }\n\n  getTemplateWithValidSettings(template: Template): TemplateWithValidSettings {\n    return {\n      ...template,\n      settings: pipe(\n        template.settings,\n        TemplateSettingsV.decode,\n        fold(\n          () => {\n            return DEFAULT_TEMPLATE_SETTINGS;\n          },\n          (templateSettings: TemplateSettings) => {\n            return templateSettings;\n          }\n        )\n      )\n    };\n  }\n\n  handleTemplateCardModal(type: \"edit\" | \"add\", newTemplate: Template) {\n    this.modalData = { type: type, data: newTemplate };\n  }\n}\n\nconst DEFAULT_TEMPLATE_SETTINGS: TemplateSettings = {\n  type: \"none\",\n  ruleGroups: []\n};\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ManageTemplates.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ManageTemplates.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ManageTemplates.vue?vue&type=template&id=53d3133e&\"\nimport script from \"./ManageTemplates.vue?vue&type=script&lang=ts&\"\nexport * from \"./ManageTemplates.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',[(_vm.isLoadingData)?_c('Loading'):_vm._e(),_c('div',{staticClass:\"manage-templates\"},[_c('div',{staticClass:\"manage-templates__header\"},[_c('h1',{staticClass:\"manage-templates__title\"},[_vm._v(\" \"+_vm._s(_vm.showTrash ? `Deleted Global Blocks` : `Global Blocks`)+\" \")]),(!_vm.showTrash)?[_c('v-btn',{staticClass:\"breakdance-wp-admin-templating-button\",attrs:{\"elevation\":\"0\",\"outlined\":\"\"},on:{\"click\":function($event){_vm.modalData = { type: 'add', data: _vm.blankGlobalBlock }}}},[_vm._v(\" Add Global Block \")])]:_vm._e()],2),(\n        this.globalBlocksByStatus.length > 0 ||\n        this.filteredBlocksBySearch.length > 0 ||\n        _vm.trashLength > 0 ||\n        _vm.showTrash\n      )?_c('div',{staticClass:\"manage-templates__actions\"},[_c('div',{staticClass:\"manage-templates__search\"},[_c('SearchInput',{attrs:{\"placeholder\":\"Search blocks\"},model:{value:(_vm.search),callback:function ($$v) {_vm.search=$$v},expression:\"search\"}})],1),(_vm.trashLength || _vm.showTrash)?_c('div',{staticClass:\"manage-templates__secondary-actions\"},[(_vm.showTrash && this.globalBlocksByStatus.length)?_c('v-btn',{attrs:{\"text\":\"\",\"loading\":_vm.emptyingTrash},on:{\"click\":_vm.emptyTrash}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"TrashIcon\",\"size\":\"16\"}}),_vm._v(\" Empty Trash \")],1):_vm._e(),(_vm.trashLength || _vm.showTrash)?_c('v-btn',{staticClass:\"mr-2\",attrs:{\"text\":\"\"},on:{\"click\":function($event){_vm.showTrash = !_vm.showTrash}}},[(_vm.showTrash)?[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"ArrowLeftLongIcon\",\"size\":\"16\"}}),_vm._v(\" Back \")]:[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"TrashIcon\",\"size\":\"16\"}}),_vm._v(\" Trash (\"+_vm._s(_vm.trashLength)+\") \")]],2):_vm._e()],1):_vm._e()]):_vm._e()]),_c('EmptyState',{attrs:{\"value\":_vm.emptyStateData}}),(_vm.filteredBlocksBySearch.length > 0)?_c('v-simple-table',{staticClass:\"manage-templates__table breakdance-table\",class:_vm.newBlockAdded ? 'added' : ''},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"Template\")]),_c('th',[_vm._v(\"Shortcode\")])])]),_c('transition-group',{attrs:{\"tag\":\"tbody\",\"name\":\"fade\",\"mode\":\"out-in\"}},_vm._l((_vm.filteredBlocksBySearch),function(block){return _c('BlockRow',{key:block.id,class:!_vm.newBlockAdded ? 'animation-disabled' : '',attrs:{\"value\":block},on:{\"input\":function($event){_vm.modalData = { type: 'edit', data: $event }},\"trash\":_vm.trashBlock,\"delete\":_vm.deleteBlock,\"restore\":_vm.restoreBlock,\"save\":_vm.saveBlockToWordPress}})}),1)],1):_vm._e(),(_vm.modalData)?_c('EditGlobalBlockModal',{attrs:{\"value\":_vm.modalData.data,\"mode\":_vm.modalData.type,\"globalBlocks\":_vm.globalBlocksByStatus},on:{\"input\":function($event){return _vm.saveBlock($event)},\"close\":function($event){_vm.modalData = false}}}):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('v-dialog',{attrs:{\"value\":true,\"max-width\":\"600\",\"persistent\":_vm.hasUnsavedChanges,\"scrollable\":true,\"transition\":false},on:{\"input\":_vm.closeDialog}},[_c('v-card',{staticClass:\"template-settings-modal-content\",attrs:{\"tile\":\"\",\"flat\":\"\",\"width\":\"600\"}},[_c('v-card-title',{staticClass:\"edit-template-modal-titlebar\"},[_c('h1',[_vm._v(\" \"+_vm._s(_vm.mode === \"add\" ? \"Add Global Block\" : `Editing \"${_vm.internalValue.label}\"`)+\" \")])]),_c('v-card-text',[_c('div',{staticClass:\"my-3\"},[_c('TextInput',{attrs:{\"value\":_vm.internalValue.label,\"placeholder\":\"New Global Block\",\"label\":\"Title\",\"size\":\"md\"},on:{\"input\":_vm.setLabel}})],1)]),_c('v-card-actions',{staticClass:\"edit-template-modal-actions\"},[_c('v-row',[_c('v-col',{staticClass:\"text-left\"},[(_vm.hasUnsavedChanges)?_c('v-btn',{attrs:{\"text\":\"\"},on:{\"click\":_vm.closeDialog}},[_vm._v(\" Cancel \")]):_vm._e()],1),_c('v-col',{staticClass:\"text-right\"},[_c('v-btn',{attrs:{\"color\":\"blue\",\"dark\":\"\",\"elevation\":\"0\",\"loading\":_vm.saveInProgress},on:{\"click\":_vm.saveGlobalBlock}},[(_vm.mode === 'edit')?[_vm._v(\"Save\")]:[_vm._v(\"Add Global Block\")]],2)],1)],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport \"@/sass/globals.scss\";\n\nimport Vue from \"vue\";\nimport { Component, Prop } from \"vue-property-decorator\";\nimport defensiveCopy from \"@/util/defensive-copy\";\nimport ConditionsMatrix from \"@/components/Reusable/CustomInputs/Conditions/ConditionsMatrix.vue\";\n\nimport DropdownInput from \"@/components/Reusable/CustomInputs/DropdownInput.vue\";\nimport TextInput from \"@/components/Reusable/CustomInputs/TextInput.vue\";\nimport NumberInput from \"@/components/Reusable/CustomInputs/NumberInput.vue\";\nimport lodash from \"lodash\";\nimport {\n  removeChangesNotSavedWarning,\n  warnIfExitingWithUnsavedChanges\n} from \"@/util/warn-unsaved-changes\";\nimport { pipe } from \"fp-ts/lib/function\";\nimport { fold } from \"fp-ts/lib/Either\";\nimport NotificationLogger from \"@/lib/notifications/notifications\";\nimport { saveGlobalBlockToWordPress } from \"@/lib/global-blocks/global-blocks\";\nimport { centerDialogInScreen } from \"@/subapps/manage-templates/lib/modal-position\";\nimport { GlobalBlock } from \"@/types/global-blocks\";\n@Component({\n  components: {\n    NumberInput,\n    TextInput,\n    DropdownInput,\n    ConditionsMatrix\n  }\n})\nexport default class EditTemplateModal extends Vue {\n  @Prop()\n  value!: GlobalBlock;\n\n  @Prop()\n  mode!: \"add\" | \"edit\";\n\n  @Prop()\n  globalBlocks!: GlobalBlock[];\n\n  internalValue: GlobalBlock = defensiveCopy(this.value);\n\n  warnIfUnsavedFunction!: (e: Event) => void;\n\n  saveInProgress = false;\n\n  mounted() {\n    centerDialogInScreen();\n\n    this.warnIfUnsavedFunction = warnIfExitingWithUnsavedChanges(\n      () => this.hasUnsavedChanges\n    );\n  }\n\n  setLabel(newTitle: string | null) {\n    this.internalValue.label = newTitle || \"\";\n  }\n\n  get hasUnsavedChanges() {\n    return !lodash.isEqual(this.internalValue, this.value);\n  }\n\n  closeDialog() {\n    removeChangesNotSavedWarning(this.warnIfUnsavedFunction);\n\n    this.$emit(\"close\");\n  }\n\n  async saveGlobalBlock() {\n    if (!this.internalValue.label) {\n      NotificationLogger.log.message(\"Title field can't be empty\");\n      return;\n    }\n\n    // The only thing differentiating global blocks when selecting them is\n    // the title. Having two equal titles is super confusing\n    if (this.globalBlocks.find(t => t.label === this.internalValue.label)) {\n      NotificationLogger.log.message(\n        `A global block with the title \"${this.internalValue.label}\" already exists. Please select another title.`\n      );\n      return;\n    }\n\n    pipe(\n      await saveGlobalBlockToWordPress(this.internalValue),\n      fold(\n        () => {\n          NotificationLogger.log.message(\"Global block was not saved\");\n        },\n        savedBlock => {\n          this.$emit(\"input\", savedBlock);\n\n          this.closeDialog();\n        }\n      )\n    );\n  }\n}\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EditGlobalBlockModal.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EditGlobalBlockModal.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./EditGlobalBlockModal.vue?vue&type=template&id=26e17d22&\"\nimport script from \"./EditGlobalBlockModal.vue?vue&type=script&lang=ts&\"\nexport * from \"./EditGlobalBlockModal.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('tr',[_c('td',[_c('a',{staticClass:\"manage-templates__title-link\",attrs:{\"target\":\"_top\",\"href\":_vm.value.editInBreakdanceLink}},[_vm._v(\" \"+_vm._s(_vm.value.label)+\" \"),_c('span',{staticClass:\"manage-templates__title-id\"},[_vm._v(\"#\"+_vm._s(_vm.value.id))])]),_c('div',{staticClass:\"manage-templates__row-actions\"},[(_vm.mode === 'publish')?_c('a',{staticClass:\"manage-templates__btn-action\",attrs:{\"href\":_vm.value.editInBreakdanceLink,\"target\":\"_top\",\"title\":\"Edit in Breakdance\"}},[_vm._v(\" Edit in Breakdance \")]):_vm._e(),(_vm.mode === 'publish')?_c('button',{staticClass:\"manage-templates__btn-action\",on:{\"click\":_vm.openEditBlockModal}},[_vm._v(\" Settings \")]):_vm._e(),(_vm.mode === 'publish')?_c('button',{staticClass:\"manage-templates__btn-action\",on:{\"click\":_vm.duplicateBlock}},[_vm._v(\" Duplicate \")]):_vm._e(),(_vm.mode === 'trash')?_c('button',{staticClass:\"manage-templates__btn-action\",attrs:{\"title\":\"Restore\"},on:{\"click\":_vm.restoreBlock}},[_vm._v(\" Restore \")]):_vm._e(),_c('button',{staticClass:\"manage-templates__btn-action is-danger\",attrs:{\"title\":_vm.mode === 'publish' ? 'Trash' : 'Delete permanently'},on:{\"click\":_vm.deleteBlock}},[_vm._v(\" \"+_vm._s(_vm.mode === \"publish\" ? \"Trash\" : \"Delete permanently\")+\" \")])])]),_c('td',[_c('input',{staticClass:\"block-shortcode\",attrs:{\"type\":\"text\"},domProps:{\"value\":`[breakdance_block blockId=${_vm.value.id}]`},on:{\"click\":_vm.highlightValue}})])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport Vue from \"vue\";\nimport { Component, Prop } from \"vue-property-decorator\";\nimport {\n  deleteTemplateFromWordPress,\n  restoreTemplateFromWordPress\n} from \"./lib/api\";\nimport Icon from \"@/components/UI/Icon.vue\";\nimport { GlobalBlock } from \"@/types/global-blocks\";\nimport defensiveCopy from \"@/util/defensive-copy\";\n\n@Component({\n  components: { Icon }\n})\nexport default class BlockRow extends Vue {\n  @Prop()\n  value!: GlobalBlock;\n\n  openEditBlockModal() {\n    this.$emit(\"input\", this.value);\n  }\n\n  duplicateBlock() {\n    const duplicatedBlock = defensiveCopy(this.value);\n\n    // tell WP to save as a new block\n    duplicatedBlock.id = -1;\n    duplicatedBlock.label = `Copy of \"${duplicatedBlock.label}\"`;\n\n    this.$emit(\"save\", duplicatedBlock);\n  }\n\n  deleteInProgress = false;\n\n  async deleteBlock() {\n    this.deleteInProgress = true;\n\n    const response = await deleteTemplateFromWordPress(\n      this.value.label,\n      this.value.id,\n      this.value.status\n    );\n\n    if (response) {\n      this.$emit(\n        this.value.status === \"publish\" ? \"trash\" : \"delete\",\n        response\n      );\n    }\n\n    this.deleteInProgress = false;\n  }\n\n  restoreInProgress = false;\n\n  async restoreBlock() {\n    this.restoreInProgress = true;\n\n    const response = await restoreTemplateFromWordPress(\n      this.value.label,\n      this.value.id\n    );\n\n    if (response) this.$emit(\"restore\", response);\n\n    this.restoreInProgress = false;\n  }\n\n  get mode() {\n    return this.value.status;\n  }\n\n  highlightValue(e: Event) {\n    // @ts-ignore\n    const selectIt = () => e.target.select();\n\n    setTimeout(() => {\n      selectIt();\n    }, 100);\n  }\n}\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./BlockRow.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./BlockRow.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./BlockRow.vue?vue&type=template&id=bb32841c&\"\nimport script from \"./BlockRow.vue?vue&type=script&lang=ts&\"\nexport * from \"./BlockRow.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./BlockRow.vue?vue&type=style&index=0&id=bb32841c&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\nimport \"@/sass/globals.scss\";\n\nimport Vue from \"vue\";\nimport { Component, Watch } from \"vue-property-decorator\";\nimport { pipe } from \"fp-ts/lib/function\";\nimport { fold } from \"fp-ts/lib/Either\";\nimport NotificationLogger from \"@/lib/notifications/notifications\";\nimport EditGlobalBlockModal from \"@/subapps/manage-templates/EditGlobalBlockModal.vue\";\nimport BlockRow from \"@/subapps/manage-templates/BlockRow.vue\";\nimport Loading from \"@/components/Reusable/Loading.vue\";\nimport {\n  saveNewTemplate,\n  changeTemplateStatus,\n  deleteAllTrash,\n  deleteTemplate\n} from \"@/subapps/manage-templates/lib/utils\";\nimport SearchInput from \"@/components/Reusable/CustomInputs/SearchInput.vue\";\nimport Icon from \"@/components/UI/Icon.vue\";\nimport {\n  emptyTrashForPostType,\n  getAllGlobalBlocksFromWordPress\n} from \"@/subapps/manage-templates/lib/api\";\nimport { GlobalBlock } from \"@/types/global-blocks\";\nimport { EmptyStateV } from \"./types\";\nimport EmptyState from \"@/subapps/manage-templates/EmptyState.vue\";\nimport { listenForNonceUpdates } from \"@/util/nonce-broadcast\";\nimport { saveGlobalBlockToWordPress } from \"@/lib/global-blocks/global-blocks\";\n\n@Component({\n  components: {\n    Icon,\n    SearchInput,\n    Loading,\n    BlockRow,\n    EditGlobalBlockModal,\n    EmptyState\n  }\n})\nexport default class ManageBreakdancePostTypes extends Vue {\n  modalData: { type: \"edit\" | \"add\"; data: GlobalBlock } | false = false;\n\n  globalBlocks: GlobalBlock[] = [];\n\n  showTrash = false;\n\n  newBlockAdded = false;\n\n  @Watch(\"newBlockAdded\")\n  onBlockAdded() {\n    setTimeout(() => (this.newBlockAdded = false), 1000);\n  }\n\n  get blankGlobalBlock(): GlobalBlock {\n    return {\n      label: \"\",\n      id: -1,\n      tree: false,\n      editInBreakdanceLink: \"\",\n      status: \"publish\"\n    };\n  }\n\n  async saveBlockToWordPress(newBlock: GlobalBlock) {\n    pipe(\n      await saveGlobalBlockToWordPress(newBlock),\n      fold(\n        () => {\n          NotificationLogger.log.message(\"Global block was not saved\");\n        },\n        savedBlock => {\n          this.saveBlock(savedBlock);\n        }\n      )\n    );\n  }\n\n  saveBlock(newBlock: GlobalBlock) {\n    this.globalBlocks = saveNewTemplate(newBlock, this.globalBlocks);\n    this.newBlockAdded = true;\n  }\n\n  deleteBlock(idToDelete: number) {\n    this.globalBlocks = deleteTemplate(idToDelete, this.globalBlocks);\n  }\n\n  trashBlock(idToDelete: number) {\n    this.globalBlocks = changeTemplateStatus(\n      idToDelete,\n      this.globalBlocks,\n      \"trash\"\n    );\n  }\n\n  restoreBlock(idToRestore: number) {\n    this.globalBlocks = changeTemplateStatus(\n      idToRestore,\n      this.globalBlocks,\n      \"publish\"\n    );\n  }\n\n  emptyingTrash = false;\n  async emptyTrash() {\n    this.emptyingTrash = true;\n\n    if (await emptyTrashForPostType(\"breakdance_block\")) {\n      this.globalBlocks = deleteAllTrash(this.globalBlocks);\n      this.showTrash = false;\n    }\n\n    this.emptyingTrash = false;\n  }\n\n  isLoadingData = false;\n  search = \"\";\n\n  get emptyStateData(): EmptyStateV {\n    return {\n      itemsByStatus: this.globalBlocksByStatus.length,\n      filteredItemsBySearch: this.filteredBlocksBySearch.length,\n      templateName: \"Global Block\",\n      showTrash: this.showTrash\n    };\n  }\n\n  get filteredBlocksBySearch() {\n    return this.globalBlocksByStatus.filter(block => {\n      return block.label.toLowerCase().includes(this.search.toLowerCase());\n    });\n  }\n\n  get globalBlocksByStatus() {\n    return this.globalBlocks.filter(block =>\n      this.showTrash ? block.status === \"trash\" : block.status === \"publish\"\n    );\n  }\n\n  get trashLength() {\n    return this.globalBlocks.filter(block => block.status === \"trash\").length;\n  }\n\n  broadcastChannel: BroadcastChannel | null = null;\n  beforeMount() {\n    this.broadcastChannel = listenForNonceUpdates();\n  }\n\n  async mounted() {\n    this.isLoadingData = true;\n\n    pipe(\n      await getAllGlobalBlocksFromWordPress(),\n      fold(\n        () => {\n          NotificationLogger.log.message(\"Couldn't load Global Blocks data\");\n        },\n        blocks => {\n          this.globalBlocks = blocks;\n        }\n      )\n    );\n\n    this.isLoadingData = false;\n  }\n\n  beforeDestroy() {\n    if (this.broadcastChannel) {\n      this.broadcastChannel.close();\n    }\n  }\n}\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ManageGlobalBlocks.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ManageGlobalBlocks.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ManageGlobalBlocks.vue?vue&type=template&id=5fdb88e0&\"\nimport script from \"./ManageGlobalBlocks.vue?vue&type=script&lang=ts&\"\nexport * from \"./ManageGlobalBlocks.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\nimport \"@/sass/globals.scss\";\n\nimport Vue from \"vue\";\nimport { Component, Prop } from \"vue-property-decorator\";\nimport { SupportedPostType } from \"./types\";\nimport Notifications from \"@/components/Notifications/Notifications.vue\";\nimport ManageTemplates from \"@/subapps/manage-templates/ManageTemplates.vue\";\nimport ManageGlobalBlocks from \"@/subapps/manage-templates/ManageGlobalBlocks.vue\";\nimport { initializeOrReinitializeCombokeys } from \"@/lib/keyboard-shortcuts/keyboard-shortcuts\";\nimport { configStore } from \"@/store/store-accessor\";\n\n@Component({\n  components: {\n    ManageGlobalBlocks,\n    ManageTemplates,\n    Notifications\n  }\n})\nexport default class ManageBreakdancePostTypes extends Vue {\n  @Prop()\n  postType!: SupportedPostType;\n\n  addingTemplate = false;\n\n  mounted() {\n    initializeOrReinitializeCombokeys(document);\n\n    configStore.setSubscriptionMode(window.Breakdance.subscriptionMode);\n  }\n\n  get isBlockPostType() {\n    return (\n      this.postType === \"breakdance_block\" ||\n      this.postType === \"breakdance_acf_block\"\n    );\n  }\n}\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ManageBreakdancePostTypes.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ManageBreakdancePostTypes.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ManageBreakdancePostTypes.vue?vue&type=template&id=62dbab44&\"\nimport script from \"./ManageBreakdancePostTypes.vue?vue&type=script&lang=ts&\"\nexport * from \"./ManageBreakdancePostTypes.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ManageBreakdancePostTypes.vue?vue&type=style&index=0&id=62dbab44&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from \"vue\";\nimport store from \"@/store/store\";\nimport vuetify from \"@/plugins/vuetify\";\nimport ManageBreakdancePostTypes from \"./ManageBreakdancePostTypes.vue\";\nimport permission from \"@/lib/permissions/directive\";\n\nVue.directive(\"permission\", permission);\nVue.config.productionTip = false;\n\n// WP ensures this page is only accessible through the registered post types\nconst postType = new URLSearchParams(window.parent.location.search).get(\"page\");\n\nnew Vue({\n  store,\n  // @ts-ignore\n  vuetify,\n  render: h =>\n    h(ManageBreakdancePostTypes, {\n      props: {\n        postType\n      }\n    })\n}).$mount(\"#manage-templates-wrapper\");\n","import { makeWordPressAjaxRequest } from \"@/lib/wordpress/ajax\";\nimport {\n  ManageTemplatesDataToLoadV,\n  SupportedPostType,\n  TemplateStatus,\n  TemplateWithValidSettings,\n  TemplateWithValidSettingsV\n} from \"../types\";\nimport * as t from \"io-ts\";\nimport { GlobalBlocksV } from \"@/types/global-blocks\";\nimport { pipe } from \"fp-ts/lib/function\";\nimport { fold } from \"fp-ts/lib/Either\";\nimport NotificationLogger from \"@/lib/notifications/notifications\";\nimport { fpJsonStringify } from \"@/util/fp-json-stringify\";\n\n/**\n * if template.id refers to a template that exists, it will be updated\n * if not, it will be created\n *\n * the template as it exists on the server after saving will be returned by this function\n */\nexport async function saveTemplateToWordPress(\n  template: TemplateWithValidSettings\n) {\n  return await makeWordPressAjaxRequest({\n    action: \"breakdance_manage_templates_save\",\n    dataToPost: {\n      id: template.id,\n      title: template.title,\n      postType: template.postType,\n      settings: fpJsonStringify(template.settings)\n    },\n    decoder: TemplateWithValidSettingsV,\n    resultKey: \"data\",\n    friendlyName: \"Save template\"\n  });\n}\n\nexport async function duplicateTemplateToWordPress(\n  template: TemplateWithValidSettings\n) {\n  return await makeWordPressAjaxRequest({\n    action: \"breakdance_manage_templates_duplicate\",\n    dataToPost: {\n      originalId: template.id,\n      title: template.title,\n      postType: template.postType,\n      settings: fpJsonStringify(template.settings)\n    },\n    decoder: TemplateWithValidSettingsV,\n    resultKey: \"data\",\n    friendlyName: \"Duplicate template\"\n  });\n}\n\nexport async function getAllTemplatesAndNeededDataFromWordPress(\n  postType: SupportedPostType\n) {\n  return await makeWordPressAjaxRequest({\n    action: \"breakdance_manage_templates_load_data\",\n    dataToPost: {\n      // eslint-disable-next-line @typescript-eslint/naming-convention\n      post_type: postType\n    },\n    decoder: ManageTemplatesDataToLoadV,\n    resultKey: \"data\",\n    friendlyName: \"Get templates data\"\n  });\n}\n\nexport async function getAllGlobalBlocksFromWordPress() {\n  return await makeWordPressAjaxRequest({\n    action: \"breakdance_manage_global_blocks\",\n    decoder: GlobalBlocksV,\n    resultKey: \"data\",\n    friendlyName: \"Get global blocks data\"\n  });\n}\n\nexport async function deleteTemplateFromWordPress(\n  title: string,\n  id: number,\n  status: TemplateStatus | undefined\n) {\n  if (\n    !confirm(\n      `${\n        status === \"publish\" ? \"Moving to trash\" : \"Permanently deleting\"\n      } \"${title}\". Are you sure?`\n    )\n  )\n    return undefined;\n\n  return pipe(\n    await makeWordPressAjaxRequest({\n      action: \"breakdance_manage_templates_delete\",\n      dataToPost: {\n        id,\n        trashOrDelete: status === \"trash\" ? \"delete\" : \"trash\"\n      },\n      decoder: t.literal(\"success\"),\n      resultKey: \"data\",\n      friendlyName: `Deleting \"${title}\"`\n    }),\n    fold(\n      () => {\n        NotificationLogger.log.message(`Failed to delete \"${title}\"`);\n        return undefined;\n      },\n      () => {\n        return id;\n      }\n    )\n  );\n}\n\nexport async function restoreTemplateFromWordPress(title: string, id: number) {\n  if (!confirm(`Restoring \"${title}\". Are you sure?`)) return undefined;\n\n  return pipe(\n    await makeWordPressAjaxRequest({\n      action: \"breakdance_manage_templates_restore\",\n      dataToPost: {\n        id\n      },\n      decoder: t.literal(\"success\"),\n      resultKey: \"data\",\n      friendlyName: `Restoring ${title}`\n    }),\n    fold(\n      () => {\n        NotificationLogger.log.message(`Failed to restore \"${title}\"`);\n        return undefined;\n      },\n      () => {\n        return id;\n      }\n    )\n  );\n}\n\nexport async function emptyTrashForPostType(postType: SupportedPostType) {\n  if (!confirm(\"Delete all trash permanently?\")) return false;\n\n  return pipe(\n    await makeWordPressAjaxRequest({\n      action: \"breakdance_manage_templates_empty_trash\",\n      dataToPost: {\n        postType: postType\n      },\n      decoder: t.literal(\"success\"),\n      resultKey: \"data\",\n      friendlyName: `Emptying trash for ${postType}`\n    }),\n    fold(\n      () => {\n        return false;\n      },\n      () => {\n        return true;\n      }\n    )\n  );\n}\n","import defensiveCopy from \"@/util/defensive-copy\";\nimport {\n  Template,\n  TemplateSettings,\n  TemplateStatus\n} from \"@/subapps/manage-templates/types\";\nimport isEqual from \"lodash/isEqual\";\n\ninterface WithIdAndStatus {\n  id: number;\n  status?: TemplateStatus;\n}\n\nexport function saveNewTemplate<T extends WithIdAndStatus>(\n  newTemplate: T,\n  templates: T[]\n) {\n  const templateIndex = templates.findIndex(t => t.id === newTemplate.id);\n\n  const newTemplates = defensiveCopy(templates);\n\n  if (templateIndex !== -1) {\n    newTemplates[templateIndex] = defensiveCopy(newTemplate);\n  } else {\n    newTemplates.unshift(defensiveCopy(newTemplate));\n  }\n\n  return newTemplates;\n}\n\nexport function deleteTemplate<T extends WithIdAndStatus>(\n  idToDelete: number,\n  templates: T[]\n) {\n  const templateIndex = templates.findIndex(\n    t => \"id\" in t && t.id === idToDelete\n  );\n\n  const newTemplates = defensiveCopy(templates);\n\n  if (templateIndex !== -1) {\n    newTemplates.splice(templateIndex, 1);\n  }\n\n  return newTemplates;\n}\n\nexport function changeTemplateStatus<T extends WithIdAndStatus>(\n  idToDelete: number,\n  templates: T[],\n  status: TemplateStatus\n) {\n  const templateIndex = templates.findIndex(\n    t => \"id\" in t && t.id === idToDelete\n  );\n\n  const newTemplates = defensiveCopy(templates);\n\n  if (templateIndex !== -1) {\n    newTemplates[templateIndex].status = status;\n  }\n\n  return newTemplates;\n}\n\nexport function deleteAllTrash<T extends WithIdAndStatus>(templates: T[]) {\n  return defensiveCopy(templates).filter(t => t.status !== \"trash\");\n}\n\nexport function checkIfTemplateSettingsAlreadyExistsAndConfirmToContinue(\n  templates: Template[],\n  templateSettings: TemplateSettings,\n  templateName: string\n) {\n  const templateSettingsAlreadyExists = templates.find(t =>\n    isEqual(t.settings, templateSettings)\n  );\n\n  return templateSettingsAlreadyExists\n    ? confirm(\n        `You already have a ${templateName} with the same settings called \"${templateSettingsAlreadyExists.title}\". Continue anyway?`\n      )\n    : true;\n}\n","import { ConditionV, RuleGroupV, TriggersV } from \"@/types/conditions\";\nimport { DynamicFieldV } from \"@/types/dynamic-data\";\nimport * as t from \"io-ts\";\nimport { EnvironmentV } from \"@/types/load\";\n\nexport const TemplateTypeV = t.intersection([\n  t.type({\n    slug: t.string,\n    label: t.string\n  }),\n  t.partial({\n    defaultPriority: t.number\n  })\n]);\n\nexport const TemplateParentsV = t.array(\n  t.type({\n    text: t.string,\n    value: t.number\n  })\n);\n\nexport type TemplateParents = t.TypeOf<typeof TemplateParentsV>;\n\nexport const TemplateTypeCategoriesV = t.array(\n  t.type({\n    label: t.string,\n    types: t.array(TemplateTypeV)\n  })\n);\n\nexport type TemplateTypeCategories = t.TypeOf<typeof TemplateTypeCategoriesV>;\n\nexport const TemplateSettingsV = t.partial({\n  parentId: t.number,\n  type: t.string,\n  ruleGroups: t.array(RuleGroupV),\n  triggers: TriggersV,\n  priority: t.number,\n  disabled: t.boolean,\n  fallback: t.boolean,\n  onlyShowOnce: t.boolean,\n  avoidMultiple: t.boolean,\n  limitPageLoad: t.union([t.number, t.null]),\n  limitSession: t.union([t.number, t.null]),\n  limitForever: t.union([t.number, t.null])\n});\n\nexport type TemplateSettings = t.TypeOf<typeof TemplateSettingsV>;\n\nexport const SupportedPostTypeV = t.union([\n  t.literal(\"breakdance_template\"),\n  t.literal(\"breakdance_popup\"),\n  t.literal(\"breakdance_header\"),\n  t.literal(\"breakdance_footer\"),\n  t.literal(\"breakdance_block\"),\n  t.literal(\"breakdance_acf_block\")\n]);\n\nexport type SupportedPostType = t.TypeOf<typeof SupportedPostTypeV>;\n\nexport const PartialTemplateV = t.type({\n  id: t.number,\n  title: t.string,\n  editInBreakdanceLink: t.string,\n  postType: SupportedPostTypeV,\n  status: t.union([t.literal(\"publish\"), t.literal(\"trash\"), t.undefined])\n});\n\nexport const TemplateV = t.intersection([\n  PartialTemplateV,\n  t.type({\n    settings: t.union([TemplateSettingsV, t.null])\n  })\n]);\n\nexport type Template = t.TypeOf<typeof TemplateV>;\n\nexport const TemplateWithValidSettingsV = t.intersection([\n  PartialTemplateV,\n  t.type({\n    settings: TemplateSettingsV\n  })\n]);\n\nexport type TemplateWithValidSettings = t.TypeOf<\n  typeof TemplateWithValidSettingsV\n>;\n\nconst PopupTriggersV = t.type({\n  text: t.string,\n  value: t.string,\n  proOnly: t.union([t.undefined, t.boolean])\n});\n\nexport type PopupTriggers = t.TypeOf<typeof PopupTriggersV>;\n\nexport const TemplatesManagementDataV = t.type({\n  conditions: t.array(ConditionV),\n  dynamicFields: t.array(DynamicFieldV),\n  templateTypeCategories: TemplateTypeCategoriesV,\n  popupTriggers: t.union([t.null, t.array(PopupTriggersV)])\n});\n\nexport type TemplatesManagementData = t.TypeOf<typeof TemplatesManagementDataV>;\n\nexport const ManageTemplatesDataToLoadV = t.type({\n  templates: t.array(TemplateV),\n  templatesManagementData: TemplatesManagementDataV,\n  isWooCommerceActive: t.boolean,\n  environment: EnvironmentV\n});\n\nexport type ManageTemplatesDataToLoad = t.TypeOf<\n  typeof ManageTemplatesDataToLoadV\n>;\n\nexport type QuickAddTemplate = {\n  name: string;\n  textColor: string;\n  backgroundColor: string;\n  category: string;\n  settings: TemplateSettings;\n  openDialog?: boolean;\n};\n\nexport type TemplateStatus = \"publish\" | \"trash\";\n\nexport type EmptyStateV = {\n  itemsByStatus: number;\n  filteredItemsBySearch: number;\n  templateName:\n    | \"Template\"\n    | \"Footer\"\n    | \"Header\"\n    | \"Unsupported template\"\n    | \"Popup\"\n    | \"Global Block\";\n  showTrash: boolean;\n};\n","import * as t from \"io-ts\";\nimport { FontV } from \"@/types/fonts\";\n\n// Custom font types\nconst FontFileV = t.type({\n  fileName: t.string,\n  fileUrl: t.string,\n  format: t.union([t.literal(\"woff\"), t.literal(\"woff2\")])\n});\n\nconst FontFaceV = t.type({\n  id: t.string,\n  files: t.array(FontFileV),\n  weight: t.number,\n  style: t.union([t.literal(\"normal\"), t.literal(\"italic\")])\n});\n\nexport const CustomFontFamilyV = t.type({\n  id: t.string,\n  family: t.string,\n  cssUrl: t.string,\n  hasExternalCssUrl: t.boolean,\n  cssName: t.string,\n  fallbackString: t.union([t.string, t.undefined]),\n  faces: t.array(FontFaceV)\n});\n\nexport type FontFile = t.TypeOf<typeof FontFileV>;\nexport type CustomFontFamily = t.TypeOf<typeof CustomFontFamilyV>;\nexport type FontFace = t.TypeOf<typeof FontFaceV>;\n\n// Fetch responses types\nexport const FontFamiliesResponseV = t.array(\n  t.type({\n    fontId: t.string,\n    cssUrl: t.string,\n    fontRegistrationData: FontV\n  })\n);\nexport const FontFileResponseV = t.type({\n  fileUrl: t.string,\n  fileName: t.string\n});\n\nexport type FontFamiliesResponse = t.TypeOf<typeof FontFamiliesResponseV>;\nexport type FontFileResponse = t.TypeOf<typeof FontFileResponseV>;\n","import * as t from \"io-ts\";\n\nexport const DesignProviderMetaV = t.type({\n  thumbnailUrl: t.union([t.string, t.undefined])\n});\n\nexport const DesignProviderV = t.type({\n  name: t.string,\n  url: t.string,\n  type: t.union([\n    t.literal(\"complete_site\"),\n    t.literal(\"sections\"),\n    t.literal(\"ui_kit\"),\n    t.undefined\n  ]),\n  isLocal: t.union([t.boolean, t.undefined]),\n  meta: t.union([t.undefined, DesignProviderMetaV])\n});\n\nexport type DesignProvider = t.TypeOf<typeof DesignProviderV>;\n\n// partial for backward compatibility\nexport const DesignLibraryDataV = t.type({\n  designProviders: t.array(DesignProviderV),\n  globalSettingsLastImportedFromUrl: t.union([t.string, t.null]),\n  designPresetsLastImportedFromUrl: t.union([t.string, t.null]),\n  fullSiteLastImportedFromUrl: t.union([t.string, t.null])\n});\n\nexport type DesignLibraryData = t.TypeOf<typeof DesignLibraryDataV>;\n\n// Design Sets\nexport const DesignSetPostV = t.type({\n  id: t.number,\n  name: t.string,\n  url: t.string,\n  tags: t.array(t.string)\n});\n\nexport const DesignSetDataV = t.type({\n  enabled: t.boolean,\n  // needed for backward compatibility. There may be design sets on an older version on Breakdance\n  // without \"reliesOnGlobalSettings\"\n  reliesOnGlobalSettings: t.union([t.boolean, t.undefined]),\n  reliesOnDesignPresets: t.union([t.boolean, t.undefined]),\n  name: t.string,\n  requiresPassword: t.union([t.boolean, t.undefined]),\n  passwordValid: t.union([t.boolean, t.undefined]),\n  posts: t.array(DesignSetPostV)\n});\n\nexport type DesignSetPost = t.TypeOf<typeof DesignSetPostV>;\nexport type DesignSetData = t.TypeOf<typeof DesignSetDataV>;\n\n// Screenshot\n\nexport const ScreenshotV = t.type({ url: t.string, id: t.number });\n\nexport type Screenshot = t.TypeOf<typeof ScreenshotV>;\n","import * as t from \"io-ts\";\nimport { ControlV } from \"./controls\";\nimport { TreeNode } from \"@/types/tree\";\nimport { DynamicPropertyPathV } from \"@/types/dynamic-property-path\";\nimport { Either } from \"fp-ts/lib/Either\";\n\nexport const BuilderElementControlsV = t.exact(\n  t.type({\n    contentSections: t.array(ControlV),\n    designSections: t.array(ControlV),\n    settingsSections: t.array(ControlV)\n  })\n);\n\nexport type BuilderElementControls = t.TypeOf<typeof BuilderElementControlsV>;\n\nexport const BuilderElementAttributeTemplatedV = t.type({\n  name: t.string,\n  template: t.string\n});\n\nexport const BuilderElementAttributePropertyPathBasedV = t.type({\n  name: t.string,\n  propertyPath: t.string\n});\n\nexport const BuilderElementAttributeWithRawValueV = t.type({\n  name: t.string,\n  rawValue: t.string\n});\n\nexport type BuilderElementAttributeTemplated = t.TypeOf<\n  typeof BuilderElementAttributeTemplatedV\n>;\n\nexport type BuilderElementAttributePropertyPathBased = t.TypeOf<\n  typeof BuilderElementAttributePropertyPathBasedV\n>;\n\nexport type BuilderElementAttributeWithRawValue = t.TypeOf<\n  typeof BuilderElementAttributeWithRawValueV\n>;\n\nexport const BuilderElementAttributeV = t.union([\n  BuilderElementAttributeTemplatedV,\n  BuilderElementAttributePropertyPathBasedV,\n  BuilderElementAttributeWithRawValueV\n]);\n\nexport type BuilderElementAttribute = t.TypeOf<typeof BuilderElementAttributeV>;\n\nexport const BuilderElementAttributesV = t.array(BuilderElementAttributeV);\n\nexport type BuilderElementAttributes = t.TypeOf<\n  typeof BuilderElementAttributesV\n>;\n\nexport const BuilderElementAdditionalClassV = t.type({\n  name: t.string,\n  template: t.string\n});\n\nexport type BuilderElementAdditionalClass = t.TypeOf<\n  typeof BuilderElementAdditionalClassV\n>;\n\nexport const BuilderElementAdditionalClassesV = t.array(\n  BuilderElementAdditionalClassV\n);\n\nexport type BuilderElementAdditionalClasses = t.TypeOf<\n  typeof BuilderElementAdditionalClassesV\n>;\n\nexport const BuilderElementDefaultPropertiesV =\n  t.unknown; /* TODO: make this a real type */\n\nexport type BuilderElementDefaultProperties = t.TypeOf<\n  typeof BuilderElementDefaultPropertiesV\n>;\n\nconst BuilderActionDataV = t.intersection([\n  t.type({ script: t.string }),\n  t.partial({ dependencies: t.array(t.string), runForAllChildren: t.boolean })\n]);\n\nconst BuilderActionV = t.type({\n  actionData: BuilderActionDataV,\n  elements: t.array(t.string)\n});\n\nexport type BuilderActionData = t.TypeOf<typeof BuilderActionDataV>;\nexport type BuilderAction = t.TypeOf<typeof BuilderActionV>;\n\nexport const ElementDependencyAndConditionV = t.partial({\n  title: t.string,\n  // src scripts\n  scripts: t.array(t.string),\n  // js code added to head\n  inlineScripts: t.array(t.string),\n  // file styles\n  styles: t.array(t.string),\n  // css added to head\n  inlineStyles: t.array(t.string),\n  // if present, dependencies run if condition is met\n  builderCondition: t.string,\n  // if present, dependencies run if condition is met\n  frontendCondition: t.string,\n  // Google fonts to import\n  googleFonts: t.array(t.string)\n});\n\nconst DependencyFiles = t.array(\n  t.type({\n    name: t.string,\n    url: t.string\n  })\n);\n\nexport const AvailableDependencyFilesV = t.type({\n  name: t.string,\n  files: t.type({\n    js: DependencyFiles,\n    css: DependencyFiles\n  })\n});\n\nexport type AvailableDependencyFiles = t.TypeOf<\n  typeof AvailableDependencyFilesV\n>;\n\nexport const BuilderActionsV = t.partial({\n  onPropertyChange: t.array(BuilderActionDataV),\n  onAfterDeletedElement: t.array(BuilderActionDataV),\n  onMovedElement: t.array(BuilderActionDataV),\n  onMountedElement: t.array(BuilderActionDataV),\n  onCreatedElement: t.array(BuilderActionDataV),\n  onBeforeDeletingElement: t.array(BuilderActionDataV),\n  onActivatedElement: t.array(BuilderActionDataV)\n});\n\nexport type BuilderActions = t.TypeOf<typeof BuilderActionsV>;\nexport type BuilderActionNames = keyof BuilderActions;\n\nexport type ElementDependencyAndCondition = t.TypeOf<\n  typeof ElementDependencyAndConditionV\n>;\n\nexport const NestingRuleTypeV = t.union([\n  // root: the root of the entire page. Only the Tree's root element. All elements go inside it.\n  t.literal(\"root\"),\n\n  // final: nothing can be inside of it. It's the final element.\n  // (like a text, header, or most of the fancy elements)\n  t.literal(\"final\"),\n\n  // final-link: like final but it's a link. Important because we can't have links inside links  that's invalid HTML),\n  // so final-link cannot be inside container-link\n  t.literal(\"final-link\"),\n\n  // container: accept any element as children except section\n  t.literal(\"container\"),\n\n  // container-restricted: only accepts elements that are registered to be its children  with restrictedToBeADirectChildOf.\n  // Powerful to enable only certain elements inside other elements.\n  // E.g: Slide can only be inside Slider; Tab only inside Tabs\n  t.literal(\"container-restricted\"),\n\n  // container-link: a container that's a link. Accepts everything a container does minus final-link\n  t.literal(\"container-link\"),\n\n  // container-excluding-self: a container that can't include itself. E.g \"product builder\" can't be inside \"product builder\"\n  t.literal(\"container-excluding-self\"),\n\n  // section: like container but can only be a direct child of root\n  t.literal(\"section\"),\n\n  // final-that-is-allowed-inside-root: an element that can be a direct descendant of root\n  // (aka not wrapped around a section) and that doesn't accept any children.\n  t.literal(\"final-that-is-allowed-inside-root\"),\n\n  // popup: can be a direct child of root, but only on breakdance_popup post type\n  t.literal(\"popup\")\n]);\n\nexport type NestingRuleType = t.TypeOf<typeof NestingRuleTypeV>;\n\nexport type LegalPlaceToAddElementInTree =\n  | \"TOP_LEVEL\"\n  | { index: false | number; place: TreeNode };\n\nexport type NoPlaceToAddElementInTree =\n  | \"NONE\"\n  | \"NOT_ALLOWED_BECAUSE_OF_OTHER_NODES\";\n\nexport type PlaceToAddElementInTree = Either<\n  NoPlaceToAddElementInTree,\n  LegalPlaceToAddElementInTree\n>;\n\nexport type CustomDocumentPostTypes =\n  | \"breakdance_block\"\n  | \"breakdance_acf_block\"\n  | \"breakdance_popup\";\n\nexport const BuilderElementNestingRuleV = t.intersection([\n  t.type({\n    type: NestingRuleTypeV\n  }),\n  t.partial({\n    restrictedToBeADirectChildOf: t.array(t.string),\n    restrictedToBeADescendantOf: t.array(t.string),\n    notAllowedWhenNodeTypeIsPresentInTree: t.array(t.string)\n  })\n]);\n\nexport type BuilderElementNestingRule = t.TypeOf<\n  typeof BuilderElementNestingRuleV\n>;\n\n/**\n * It's important that this and SpacingBarLocationV stay in sync and in order\n */\nexport const SpacingBarLocationV = t.union([\n  t.literal(\"inside-top\"),\n  t.literal(\"inside-left\"),\n  t.literal(\"inside-right\"),\n  t.literal(\"inside-bottom\"),\n  t.literal(\"outside-top\"),\n  t.literal(\"outside-right\"),\n  t.literal(\"outside-left\"),\n  t.literal(\"outside-bottom\")\n]);\n\nexport const SpacingBarCssProperty = t.union([\n  t.literal(\"padding-top\"),\n  t.literal(\"padding-left\"),\n  t.literal(\"padding-right\"),\n  t.literal(\"padding-bottom\"),\n  t.literal(\"margin-top\"),\n  t.literal(\"margin-right\"),\n  t.literal(\"margin-left\"),\n  t.literal(\"margin-bottom\")\n]);\n\n/**/\n\nconst PropertyPathsPropertyV = t.union([t.literal(false), t.array(t.string)]);\n\nexport type PropertyPathsProperty = t.TypeOf<typeof PropertyPathsPropertyV>;\n\nexport type SpacingBarLocation = t.TypeOf<typeof SpacingBarLocationV>;\n\nexport type SpacingBarProperty = t.TypeOf<typeof SpacingBarCssProperty>;\n\nexport const SpacingBarDescriptionV = t.type({\n  location: SpacingBarLocationV,\n  cssProperty: SpacingBarCssProperty,\n  affectedPropertyPath: t.string\n});\n\nexport type SpacingBarDescription = t.TypeOf<typeof SpacingBarDescriptionV>;\n\nexport type DefaultChildElementInterface = {\n  slug: string;\n  defaultProperties?: BuilderElementDefaultProperties;\n  children?: DefaultChildElementInterface[];\n};\n\nexport const DefaultChildElementV: t.Type<DefaultChildElementInterface> =\n  t.recursion(\"ChildElement\", () =>\n    t.intersection([\n      t.type({\n        slug: t.string\n      }),\n      t.partial({\n        defaultProperties: BuilderElementDefaultPropertiesV,\n        children: t.array(DefaultChildElementV)\n      })\n    ])\n  );\n\nexport type DefaultChildElement = t.TypeOf<typeof DefaultChildElementV>;\n\nexport const RequiredPluginV = t.union([\n  t.literal(\"WooCommerce\"),\n  t.literal(\"ACF\"),\n  t.literal(\"MetaBox\"),\n  t.literal(\"ACF\"),\n  t.literal(\"FacetWP\"),\n  t.literal(\"WP Grid Builder\")\n]);\nexport type RequiredPlugin = t.TypeOf<typeof RequiredPluginV>;\n\nconst ElementSettingsV = t.union([\n  t.partial({\n    dependsOnGlobalScripts: t.boolean,\n    bypassPointerEvents: t.boolean,\n    sharePropsWithSSRChildren: t.boolean,\n    requiredPlugins: t.array(RequiredPluginV),\n    disableAI: t.boolean,\n    proOnly: t.boolean\n  }),\n  t.literal(false)\n]);\nexport type ElementSettings = t.TypeOf<typeof ElementSettingsV>;\n\nexport const AddPanelRulesV = t.union([\n  t.literal(false),\n  t.partial({\n    alwaysHide: t.boolean,\n    allowedPostTypes: t.array(t.string)\n  })\n]);\n\nexport type AddPanelRules = t.TypeOf<typeof AddPanelRulesV>;\n\nexport const BuilderElementProjectManagementValueV = t.union([\n  t.literal(\"yes\"),\n  t.literal(\"no\"),\n  t.literal(\"unknown\"),\n  t.literal(\"sort of\")\n]);\n\nexport const BuilderElementProjectManagementV = t.partial({\n  looksGood: BuilderElementProjectManagementValueV,\n  optionsGood: BuilderElementProjectManagementValueV,\n  optionsWork: BuilderElementProjectManagementValueV,\n  dynamicBehaviorWorks: BuilderElementProjectManagementValueV,\n  notes: t.string\n});\n\nexport type BuilderElementProjectManagement = t.TypeOf<\n  typeof BuilderElementProjectManagementV\n>;\nexport type BuilderElementProjectManagementValue = t.TypeOf<\n  typeof BuilderElementProjectManagementValueV\n>;\n\nexport const BadgeV = t.type({\n  backgroundColor: t.union([t.string, t.null]),\n  textColor: t.union([t.string, t.null]),\n  label: t.string\n});\n\nexport type Badge = t.TypeOf<typeof BadgeV>;\n\nexport const BuilderElementV = t.exact(\n  t.type({\n    name: t.string,\n    className: t.union([t.string, t.literal(false)]),\n    uiIcon: t.union([t.string, t.literal(false)]),\n    slug: t.string,\n    category: t.string,\n    badge: t.union([BadgeV, t.literal(false)]),\n    htmlTag: t.type({\n      default: t.string,\n      options: t.array(t.string),\n      pathToControl: t.union([t.literal(false), t.string])\n    }),\n    template: t.string,\n    additionalClasses: t.union([\n      BuilderElementAdditionalClassesV,\n      t.literal(false)\n    ]),\n    attributes: t.union([BuilderElementAttributesV, t.literal(false)]),\n    cssTemplate: t.string,\n    defaultCss: t.string,\n    defaultProperties: t.union([\n      BuilderElementDefaultPropertiesV,\n      t.literal(false)\n    ]),\n    defaultChildren: t.union([t.array(DefaultChildElementV), t.literal(false)]),\n    controls: BuilderElementControlsV,\n    dependencies: t.union([\n      t.array(ElementDependencyAndConditionV),\n      t.literal(false)\n    ]),\n    actions: t.union([BuilderActionsV, t.literal(false)]),\n    nestingRule: BuilderElementNestingRuleV,\n    spacingBars: t.union([t.literal(false), t.array(SpacingBarDescriptionV)]),\n    dynamicPropertyPaths: t.union([\n      t.literal(false),\n      t.array(DynamicPropertyPathV)\n    ]),\n    settings: ElementSettingsV,\n    addPanelRules: AddPanelRulesV,\n    experimental: t.boolean,\n    order: t.number,\n    projectManagement: t.union([\n      t.literal(false),\n      BuilderElementProjectManagementV\n    ]),\n    propertyPathsToWhitelistInFlatProps: PropertyPathsPropertyV,\n    propertyPathsToSsrElementWhenValueChanges: PropertyPathsPropertyV\n  })\n);\n\nexport type BuilderElement = t.TypeOf<typeof BuilderElementV>;\n\nexport const BuilderElementsArrayV = t.array(BuilderElementV);\n\nexport type BuilderElements = Record<\n  BuilderElement[\"slug\"],\n  BuilderElement | undefined\n>;\n\nexport const BuilderElementCategoryV = t.type({\n  slug: t.string,\n  label: t.string\n});\nexport const BuilderElementCategoriesV = t.array(BuilderElementCategoryV);\n\nexport type BuilderElementCategory = t.TypeOf<typeof BuilderElementCategoryV>;\n\nexport const ElementsExternalAttrsDepsAndActionsV = t.partial({\n  attributes: t.array(BuilderElementAttributeV),\n  dependencies: t.array(ElementDependencyAndConditionV),\n  actions: BuilderActionsV\n});\n\nexport type ElementsExternalAttrsDepsAndActions = t.TypeOf<\n  typeof ElementsExternalAttrsDepsAndActionsV\n>;\n\nexport const MacrosDataV = t.array(\n  t.type({\n    macro: t.string,\n    slug: t.string\n  })\n);\n\nexport type MacrosData = t.TypeOf<typeof MacrosDataV>;\n","import * as t from \"io-ts\";\nimport { MaybeExportedTreeV } from \"./tree\";\n\nexport const GlobalBlockV = t.intersection([\n  t.type({\n    label: t.string,\n    id: t.number, // can be -1 when creating a new post\n    tree: MaybeExportedTreeV,\n    editInBreakdanceLink: t.string\n  }),\n  t.partial({\n    status: t.union([t.literal(\"publish\"), t.literal(\"trash\")])\n  })\n]);\n\nexport type GlobalBlock = t.TypeOf<typeof GlobalBlockV>;\n\nexport const GlobalBlocksV = t.array(GlobalBlockV);\n","import * as t from \"io-ts\";\nimport { DynamicFieldsV } from \"@/types/dynamic-data\";\nimport {\n  BuilderElementV,\n  BuilderElementCategoriesV,\n  RequiredPluginV,\n  ElementsExternalAttrsDepsAndActionsV,\n  MacrosDataV\n} from \"@/types/elements\";\nimport { PropertiesDataV } from \"@/types/tree\";\nimport { FontsV } from \"@/types/fonts\";\nimport { GlobalSettingsControlsAndTemplateV } from \"./global-and-document-settings\";\nimport { BreakdancePluginsV } from \"./plugins\";\nimport { TemplatePreviewV } from \"./templates\";\nimport { LoadedSelectorDataV } from \"./selectors\";\nimport {\n  BreakdanceNeededDataV,\n  BreakdanceDocumentSpecificNeededUrlsV\n} from \"@/types/config\";\nimport {\n  DocumentMetasV,\n  BreakdanceDocumentWithExportedTreeV\n} from \"@/types/document\";\nimport { ConditionsV } from \"./conditions\";\nimport { PreferencesV } from \"./preferences\";\nimport { ElementPresetsV } from \"./presets\";\nimport { BreakpointV } from \"./breakpoints\";\nimport { PermissionV } from \"@/types/permission\";\nimport { GlobalMediaSizeV } from \"@/types/media\";\nimport { DesignLibraryDataV } from \"@/types/design-library\";\nimport { getIoTsStringsUnionFromConstStringArray } from \"@/util/type-assertions\";\n\nconst InvalidPostsErrorV = t.union([\n  t.literal(\"post_does_not_exist\"),\n  t.literal(\"post_type_is_banned\"),\n  t.literal(\"post_type_is_restricted\"),\n  t.literal(\"post_is_in_trash\")\n]);\n\nconst InvalidPostDataV = t.type({\n  errorType: InvalidPostsErrorV,\n  postType: t.union([t.undefined, t.string]),\n  backToAdminUrl: t.string\n});\n\nexport type InvalidPostData = t.TypeOf<typeof InvalidPostDataV>;\n\nexport const subscriptionMode = [\"free\", \"pro\"] as const;\n\nexport const SubscriptionModeV =\n  getIoTsStringsUnionFromConstStringArray(subscriptionMode);\n\nexport type SubscriptionMode = t.TypeOf<typeof SubscriptionModeV>;\n\nexport const AiV = t.type({\n  enabled: t.boolean\n});\n\nexport type Ai = t.TypeOf<typeof AiV>;\n\nexport const EnvironmentV = t.union([\n  t.literal(\"local\"),\n  t.literal(\"production\")\n]);\n\nexport type Environment = t.TypeOf<typeof EnvironmentV>;\nconst ConfigDataLoadedFromWordPressV = t.type({\n  environment: EnvironmentV,\n  elementPresets: ElementPresetsV,\n  neededData: BreakdanceNeededDataV,\n  builderElements: t.array(BuilderElementV),\n  elementsExternalAttrsDepsAndActions: ElementsExternalAttrsDepsAndActionsV,\n  builderElementCategories: BuilderElementCategoriesV,\n  preferences: PreferencesV,\n  dynamicFields: DynamicFieldsV,\n  conditions: ConditionsV,\n  fonts: FontsV,\n  globalSettingsControlsAndTemplate: GlobalSettingsControlsAndTemplateV,\n  globalSettings: PropertiesDataV,\n  plugins: BreakdancePluginsV,\n  availableDocuments: DocumentMetasV,\n  selectors: LoadedSelectorDataV,\n  availableMediaSizes: t.array(GlobalMediaSizeV),\n  availablePermissions: t.array(PermissionV),\n  availableWordpressPlugins: t.array(RequiredPluginV),\n  permission: PermissionV,\n  builtinBreakpoints: t.array(BreakpointV),\n  twigMacros: MacrosDataV,\n  twigMacrosHash: t.string,\n  designLibrary: DesignLibraryDataV,\n  subscriptionMode: SubscriptionModeV,\n  experiments: t.array(t.string),\n  ai: AiV\n});\n\nexport type ConfigDataLoadedFromWordPress = t.TypeOf<\n  typeof ConfigDataLoadedFromWordPressV\n>;\n\nconst DocumentDataLoadedFromWordPressV = t.intersection([\n  t.type({\n    document: BreakdanceDocumentWithExportedTreeV,\n    documentSpecificNeededUrls: BreakdanceDocumentSpecificNeededUrlsV,\n    templatePreview: TemplatePreviewV\n  }),\n  ConfigDataLoadedFromWordPressV\n]);\n\nexport type DocumentDataLoadedFromWordPress = t.TypeOf<\n  typeof DocumentDataLoadedFromWordPressV\n>;\n\nexport const ExpectedDataToLoadDocumentV = t.union([\n  InvalidPostDataV,\n  DocumentDataLoadedFromWordPressV\n]);\n\nexport type ExpectedDataToLoadDocument = t.TypeOf<\n  typeof ExpectedDataToLoadDocumentV\n>;\n\nexport const ExpectedDataToLoadConfigV = ConfigDataLoadedFromWordPressV;\n\nexport type ExpectedDataToLoadConfig = t.TypeOf<\n  typeof ExpectedDataToLoadConfigV\n>;\n","import { PropertiesDataV } from \"./tree\";\n\nimport * as t from \"io-ts\";\nimport { ControlV } from \"./controls\";\n\nexport const SelectorCSSNameV = t.string;\n/* would be wise ot make an io-ts typeguard to ensure it's a VALID css class name... \nand then apply that type guard to both the value emitted by the class input (most important)\n and the classes on the way in (not really important)\n*/\n\nexport type SelectorCSSName = t.TypeOf<typeof SelectorCSSNameV>;\n\nexport const CSSSelectorV = t.type({\n  name: SelectorCSSNameV,\n  type: t.union([t.literal(\"class\"), t.literal(\"custom\")]),\n  properties:\n    PropertiesDataV /* really PropertiesData is a [key: string]: ValidValue | PropertiesData, not an any */\n});\n\nexport type CSSSelector = t.TypeOf<typeof CSSSelectorV>;\n\nexport const CSSSelectorListV = t.array(CSSSelectorV);\nexport type CSSSelectorList = t.TypeOf<typeof CSSSelectorListV>;\n\nexport const LoadedSelectorDataV = t.exact(\n  t.type({\n    template: t.string,\n    controls: t.array(ControlV),\n    selectors: CSSSelectorListV\n  })\n);\n\nexport type LoadedSelectorData = t.TypeOf<typeof LoadedSelectorDataV>;\n","import * as t from \"io-ts\";\n\nexport const RepeaterFieldV = t.type({\n  field: t.string,\n  index: t.number\n});\n\nexport const TemplatePreviewableItemV = t.type({\n  label: t.string,\n  url: t.string,\n  type: t.string,\n  repeater: t.union([RepeaterFieldV, t.null, t.undefined])\n});\n\nexport const TemplatePreviewableItemsV = t.array(TemplatePreviewableItemV);\n\nexport type TemplatePreviewableItem = t.TypeOf<typeof TemplatePreviewableItemV>;\n\nexport const TemplatePreviewV = t.type({\n  previewableItems: t.union([TemplatePreviewableItemsV, t.literal(false)]),\n  lastPreviewedItem: t.union([TemplatePreviewableItemV, t.literal(false)])\n});\n\nexport type TemplatePreview = t.TypeOf<typeof TemplatePreviewV>;\n","import * as t from \"io-ts\";\nimport { Either, flatten, map, mapLeft } from \"fp-ts/lib/Either\";\nimport { _Error } from \"@/lib/wordpress/data\";\nimport fpJsonParse from \"@/util/fp-json-parse\";\nimport { flow, pipe } from \"fp-ts/lib/function\";\nimport { iotsErrorsToCustomErrorType } from \"@/util/io-ts-errors-to-_error\";\n\n/**\n * Does JSON parsing and IO-TS decoding of the parsing result.\n *\n * Example usage:\n *\n * fpJsonParseTypesafe('{\"foo\": \"bar\"}', t.typeof({foo: t.string}));\n */\nexport default function fpJsonParseTypesafe<\n  IoTsType extends t.Type<IoTsTypeTypeOf>,\n  IoTsTypeTypeOf = IoTsType extends t.Type<infer R> ? R : never\n>(\n  jsonWhichMightBeInvalid: string,\n  ioTsType: IoTsType\n): Either<_Error[], IoTsTypeTypeOf> {\n  return pipe(\n    jsonWhichMightBeInvalid,\n    fpJsonParse,\n    map(flow(ioTsType.decode, mapLeft(iotsErrorsToCustomErrorType))),\n    flatten\n  );\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.j = 93;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t93: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = globalThis[\"webpackChunkbuilder\"] = globalThis[\"webpackChunkbuilder\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998,64], () => (__webpack_require__(92788)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["getFieldsToComplete","node","acc","element","configStore","data","type","settings","disableAI","acc_","getFieldsToCompleteFromControls","controls","contentSections","children","forEach","n","path","_acc","control","controlPath","slug","isControlSupported","isValueEmpty","push","nodeId","id","nodeName","name","field","description","getFieldDescription","label","value","properties","options","locked","isFieldLocked","undefined","includes","elementType","elementName","childControls","filter","map","childControl","keys","join","endsWith","getElementPrompt","meta","promptInfo","getElementTemperature","temperature","lockFieldFromAI","fieldPath","lockedFields","newLockedFields","defensiveCopy","documentStore","elementId","snapshotLabel","unlockFieldFromAI","index","indexOf","splice","toggleFieldLock","handleAiError","error","defaultErrorMessage","cleanErrorString","slice","replace","trim","response","pipe","fpJsonParseTypesafe","OpenAIErrorV","fold","res","message","console","log","NotificationLogger","async","requestCompletion","messages","format","makeWordPressAjaxRequest","action","friendlyName","dataToPost","fpJsonStringify","decoder","t","resultKey","persistMessages","status","getEventSource","url","window","Breakdance","restUrl","restNonce","EventSource","getTextFromChunk","chunk","json","fpJsonParse","x","text","choices","delta","content","fetchAiSettings","AISettingsV","suppressErrorLogging","loadedData","breakdanceUndo","globalStore","getSettingsAsPrompt","promptSettings","overrides","metadata","businessName","businessDescription","sectionDescription","qualifiers","reduce","curr","Intl","PluralRules","AIPresetV","icon","prompt","PromptSettingsV","presets","isApiKeySet","isStreamingEnabled","locale","model","alt_description","urls","raw","full","regular","small","thumb","param","code","isObjectExcludingArray","Array","isArray","ElementClipboardDataV","TreeNodeV","ControlSectionPropertiesDataClipboardDataV","controlSectionShapeHash","propertiesData","ClipboardDataV","controlSectionPropertiesData","EasyEvent","determinePastingMethod","event","secure","permission","getClipboardStatus","safari","state","writeToClipboard","navigator","clipboard","writeText","debug","err","fallbackWriteToClipboard","writeToLocalStorage","readFromClipboard","eventText","clipboardData","getData","method","readFromLocalStorage","readText","getDataFromClipboard","clipboardJsonString","maybeClipboardData","maybeQueryClipboardPermission","permissions","query","allowWithoutGesture","e","isSecureContext","textArea","document","createElement","result","style","top","left","position","classList","add","body","appendChild","focus","select","execCommand","removeChild","getBlocksFromWordPress","GlobalBlocksV","saveGlobalBlockToWordPress","globalBlock","tree","GlobalBlockV","saveGlobalSettingsToWordPress","globalSettings","errors","logErrorsToUiStore","setGlobalSettingsAccordionState","accordionPath","expand","newPanelState","uiStore","accordionState","setDynamicDataFieldAttributesAccordionState","dynamicDataFieldAttributes","getDynamicDataFieldAttributesAccordionState","isValidClassName","test","isValidSelectorName","createDocumentFragment","querySelector","addSelector","newSelector","selector","addSelectorToStoreAndSaveSelectorsToWordPressIfSelectorsPanelIsClosed","isUiPanelOpen","saveSelectorsToWordPress","selectors","getDocumentUrlFromId","documentId","updatedUrl","URL","originalUrl","searchParams","set","search","toString","href","InitialStoreState","setupHook","store","this","initialState","resetToInitialState","newState","replaceState","_c","_self","_setup","staticClass","_vm","attrs","postType","staticRenderFns","blankTemplateWithValidSettings","isWooCommerceActive","saveTemplate","handleTemplateCardModal","$event","templatesByStatus","expression","emptyTrash","on","showTrash","filteredTemplatesBySearch","_v","class","templatesManagementData","trashTemplate","deleteTemplate","restoreTemplate","templateParentsWithoutTrashed","modalData","skipWarning","_e","render","_setupProxy","mode","_s","title","editInBreakdanceLink","openEditTemplateModal","duplicateTemplate","matchingQuickAddTemplate","backgroundColor","textColor","category","appliesToLabel","ruleGroups","length","triggerLabels","triggers","priority","disabled","updateDisabled","scopedSlots","key","ruleIndex","ConditionsPreview","Vue","edit","$emit","__decorate","Prop","Component","components","ConditionPreviewRule","Icon","component","QUICK_ADD_TEMPLATES","ruleSlug","operand","openDialog","color","TemplateRow","constructor","deleteInProgress","restoreInProgress","templateType","templateTypeLabel","templateTypeCategories","some","templateTypeCategory","currentTemplateType","types","find","deleteTemplateFromWordPress","restoreTemplateFromWordPress","duplicatedTemplate","quickAddTemplate","trigger","enabled","newTemplate","ToggleInput","ConditionsPreviewTooltip","ElementBadge","$$v","AddTemplateDropdown","open","quickAddInProgress","quickAddTemplates","template","toLowerCase","templateToAdd","checkIfTemplateSettingsAlreadyExistsAndConfirmToContinue","templates","saveTemplateToWordPress","templateName","savedTemplate","Dropdown","itemsByStatus","filteredItemsBySearch","EmptyState","isBreakdanceDevelopmentEnvironment","ManageBreakdancePostTypes","conditions","dynamicFields","popupTriggers","newTemplateAdded","hasPermissionToManageFallbacks","emptyingTrash","isLoadingData","broadcastChannel","onTemplateAdded","setTimeout","templatesForUi","fallback","trashLength","newTemplateWithOldId","duplicateTemplateToWordPress","updatedTemplate","saveNewTemplate","idToDelete","changeTemplateStatus","idToRestore","emptyTrashForPostType","deleteAllTrash","emptyStateData","searchInputPlaceholder","beforeMount","listenForNonceUpdates","keyboardShortcuts","getAllTemplatesAndNeededDataFromWordPress","environment","beforeDestroy","close","getTemplateWithValidSettings","TemplateSettingsV","DEFAULT_TEMPLATE_SETTINGS","templateSettings","Watch","SearchInput","Loading","Notifications","EditTemplateModal","blankGlobalBlock","filteredBlocksBySearch","block","saveBlockToWordPress","closeDialog","hasUnsavedChanges","internalValue","saveInProgress","mounted","centerDialogInScreen","warnIfUnsavedFunction","warnIfExitingWithUnsavedChanges","setLabel","newTitle","removeChangesNotSavedWarning","globalBlocks","savedBlock","NumberInput","TextInput","DropdownInput","ConditionsMatrix","openEditBlockModal","duplicateBlock","restoreBlock","deleteBlock","domProps","highlightValue","BlockRow","duplicatedBlock","selectIt","target","newBlockAdded","onBlockAdded","newBlock","saveBlock","trashBlock","globalBlocksByStatus","getAllGlobalBlocksFromWordPress","blocks","EditGlobalBlockModal","addingTemplate","initializeOrReinitializeCombokeys","subscriptionMode","isBlockPostType","ManageGlobalBlocks","ManageTemplates","URLSearchParams","parent","location","get","vuetify","h","props","$mount","TemplateWithValidSettingsV","originalId","post_type","ManageTemplatesDataToLoadV","confirm","trashOrDelete","templateIndex","findIndex","newTemplates","unshift","templateSettingsAlreadyExists","isEqual","TemplateTypeV","defaultPriority","TemplateTypeCategoriesV","parentId","RuleGroupV","TriggersV","onlyShowOnce","avoidMultiple","limitPageLoad","limitSession","limitForever","SupportedPostTypeV","PartialTemplateV","TemplateV","PopupTriggersV","proOnly","TemplatesManagementDataV","ConditionV","DynamicFieldV","EnvironmentV","FontFileV","fileName","fileUrl","FontFaceV","files","weight","CustomFontFamilyV","family","cssUrl","hasExternalCssUrl","cssName","fallbackString","faces","fontId","fontRegistrationData","FontV","DesignProviderMetaV","thumbnailUrl","DesignProviderV","isLocal","DesignLibraryDataV","designProviders","globalSettingsLastImportedFromUrl","designPresetsLastImportedFromUrl","fullSiteLastImportedFromUrl","DesignSetPostV","tags","ScreenshotV","reliesOnGlobalSettings","reliesOnDesignPresets","requiresPassword","passwordValid","posts","BuilderElementControlsV","ControlV","designSections","settingsSections","BuilderElementAttributeTemplatedV","BuilderElementAttributePropertyPathBasedV","propertyPath","BuilderElementAttributeWithRawValueV","rawValue","BuilderElementAttributeV","BuilderElementAttributesV","BuilderElementAdditionalClassV","BuilderElementAdditionalClassesV","BuilderElementDefaultPropertiesV","BuilderActionDataV","script","dependencies","runForAllChildren","ElementDependencyAndConditionV","actionData","elements","scripts","inlineScripts","styles","inlineStyles","builderCondition","frontendCondition","googleFonts","DependencyFiles","BuilderActionsV","js","css","onPropertyChange","onAfterDeletedElement","onMovedElement","onMountedElement","onCreatedElement","onBeforeDeletingElement","onActivatedElement","NestingRuleTypeV","BuilderElementNestingRuleV","restrictedToBeADirectChildOf","restrictedToBeADescendantOf","notAllowedWhenNodeTypeIsPresentInTree","SpacingBarLocationV","SpacingBarCssProperty","PropertyPathsPropertyV","SpacingBarDescriptionV","cssProperty","affectedPropertyPath","DefaultChildElementV","defaultProperties","RequiredPluginV","ElementSettingsV","dependsOnGlobalScripts","bypassPointerEvents","sharePropsWithSSRChildren","requiredPlugins","AddPanelRulesV","alwaysHide","allowedPostTypes","BuilderElementProjectManagementValueV","BuilderElementProjectManagementV","looksGood","optionsGood","optionsWork","dynamicBehaviorWorks","notes","BadgeV","BuilderElementV","className","uiIcon","badge","htmlTag","default","pathToControl","additionalClasses","attributes","cssTemplate","defaultCss","defaultChildren","actions","nestingRule","spacingBars","dynamicPropertyPaths","DynamicPropertyPathV","addPanelRules","experimental","order","projectManagement","propertyPathsToWhitelistInFlatProps","propertyPathsToSsrElementWhenValueChanges","BuilderElementCategoryV","BuilderElementCategoriesV","ElementsExternalAttrsDepsAndActionsV","MacrosDataV","macro","MaybeExportedTreeV","InvalidPostsErrorV","InvalidPostDataV","errorType","backToAdminUrl","SubscriptionModeV","getIoTsStringsUnionFromConstStringArray","AiV","ConfigDataLoadedFromWordPressV","elementPresets","ElementPresetsV","neededData","BreakdanceNeededDataV","builderElements","elementsExternalAttrsDepsAndActions","builderElementCategories","preferences","PreferencesV","DynamicFieldsV","ConditionsV","fonts","FontsV","globalSettingsControlsAndTemplate","GlobalSettingsControlsAndTemplateV","PropertiesDataV","plugins","BreakdancePluginsV","availableDocuments","DocumentMetasV","LoadedSelectorDataV","availableMediaSizes","GlobalMediaSizeV","availablePermissions","PermissionV","availableWordpressPlugins","builtinBreakpoints","BreakpointV","twigMacros","twigMacrosHash","designLibrary","experiments","ai","DocumentDataLoadedFromWordPressV","BreakdanceDocumentWithExportedTreeV","documentSpecificNeededUrls","BreakdanceDocumentSpecificNeededUrlsV","templatePreview","TemplatePreviewV","SelectorCSSNameV","CSSSelectorV","CSSSelectorListV","RepeaterFieldV","TemplatePreviewableItemV","repeater","TemplatePreviewableItemsV","previewableItems","lastPreviewedItem","jsonWhichMightBeInvalid","ioTsType","flow","decode","mapLeft","iotsErrorsToCustomErrorType","flatten","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","loaded","__webpack_modules__","call","m","deferred","O","chunkIds","fn","notFulfilled","Infinity","i","fulfilled","j","Object","every","r","getter","__esModule","d","a","definition","o","defineProperty","enumerable","g","globalThis","Function","obj","prop","prototype","hasOwnProperty","Symbol","toStringTag","nmd","paths","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","bind","__webpack_exports__"],"sourceRoot":""}